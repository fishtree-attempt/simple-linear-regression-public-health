<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Simple linear regression for public health: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team." style="text-decoration: unset">
           
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link" style="color: #383838">Beta
            <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #001483; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container ">
      
      <div class="beta-alert alert alert-light alert-dismissable fade show" role="alert">
        
        
        
        <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #5bbad5"></i>
        
        Workbench Beta | 
        <a href="https://carpentries.typeform.com/to/KRBl4IZM" class="external-link alert-link" style="text-decoration: wavy overline">Give Feedback</a> | 
        <a href="https://carpentries.github.io/workbench/beta-phase.html" class="external-link alert-link">Learn More</a>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Simple linear regression for public health
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Simple linear regression for public health
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="figures.html">Figures</a></li>
<li><a class="dropdown-item" href="reference.html"></a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Simple linear regression for public health
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introSLR.html">1. An introduction to linear regression</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-singleContPred.html">2. Linear regression with one continuous explanatory variable</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-twoLvlFactor.html">3. Linear regression with a two-level factor explanatory variable</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-predictionSLR.html">4. Making predictions from a simple linear regression model</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-fitAndAssumptionSLR.html">5. Assessing simple linear regression model fit and assumptions</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-multiLvlFactor.html">6. Optional: linear regression with a multi-level factor explanatory variable</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li>
<li><a href="figures.html">Figures</a></li>
<li><a href="reference.html"></a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-introSLR"><p>Content from <a href="01-introSLR.html">An introduction to linear regression</a></p>
<hr>
<p> Last updated on 2023-01-31 | 
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/01-introSLR.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What type of variables are required for simple linear
regression?</li>
<li>What do each of the components in the equation of a simple linear
regression model represent?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Identify questions that can be addressed with a simple linear
regression model.</li>
<li>Describe the components that are involved in simple linear
regression.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="questions-that-can-be-addressed-with-simple-linear-regression"><h2 class="section-heading">Questions that can be addressed with simple linear regression<a class="anchor" aria-label="anchor" href="#questions-that-can-be-addressed-with-simple-linear-regression"></a>
</h2>
<hr class="half-width">
<p>Simple linear regression is commonly used, but when is it appropriate
to apply this method? Broadly speaking, simple linear regression may be
suitable when the following conditions hold:</p>
<ul>
<li>You seek a <em>model</em> of the relationship between one
<em>continuous</em> dependent variable and one <em>continuous</em> or
<em>categorical</em> explanatory variable.</li>
<li>Your data and simple linear regression model do not violate the
assumptions of the simple linear regression model. We will cover these
assumptions in the final episode of this lesson.</li>
</ul>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>A colleague has started working with the NHANES data set. They
approach you for advice on the use of simple linear regression on these
data. Assuming that the assumptions of the simple linear regression
model hold, which of the following questions could potentially be
tackled with a simple linear regression model? Think closely about the
outcome and explanatory variables, between which a relationship will be
modelled to answer the research question.</p>
<ol style="list-style-type: upper-alpha">
<li>Does home ownership (whether a participant’s home is owned or
rented) vary across income brackets in the general US population?<br>
</li>
<li>Is there an association between BMI and pulse rate in the general US
population?<br>
</li>
<li>Do teenagers on average have a higher pulse rate than adults in the
general US population?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: upper-alpha">
<li>The outcome variable is home ownership and the explanatory variable
is income bracket. Since home ownership is a categorical outcome
variable, simple linear regression is not a suitable way to answer this
question.<br>
</li>
<li>Since both variables are continous, simple linear regression may be
a suitable way to answer this question.<br>
</li>
<li>The outcome variable is pulse rate and the explanatory variable is
age group (teenager vs adult). Since the outcome variable is continuous
and the explanatory variable is categorical, simple linear regression
may be a suitable way to answer this question.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="the-simple-linear-regression-equation"><h2 class="section-heading">The simple linear regression equation<a class="anchor" aria-label="anchor" href="#the-simple-linear-regression-equation"></a>
</h2>
<hr class="half-width">
<p>The simple linear regression model can be described by the following
equation:</p>
<p><span class="math display">\[
E(y) = \beta_0 + \beta_1 \times x_1.
\]</span></p>
<p>The outcome variable is denoted by <span class="math inline">\(y\)</span> and the explanatory variable is denoted
by <span class="math inline">\(x_1\)</span>. Simple linear regression
models the <em>expectation</em> of <span class="math inline">\(y\)</span>, i.e. <span class="math inline">\(E(y)\)</span>. This is another way of referring to
the <em>mean</em> of <span class="math inline">\(y\)</span>. The
expectation of <span class="math inline">\(y\)</span> is a function of
<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1 \times x_1\)</span>. The intercept is
denoted by <span class="math inline">\(\beta_0\)</span> - this is the
value of <span class="math inline">\(E(y)\)</span> when the explanatory
variable, <span class="math inline">\(x_1\)</span>, equals 0. The effect
of our explanatory variable is denoted by <span class="math inline">\(\beta_1\)</span> - for every one-unit increase in
<span class="math inline">\(x_1\)</span>, <span class="math inline">\(E(y)\)</span> changes by <span class="math inline">\(\beta_1\)</span>.</p>
<p>Before fitting the model, we have access to <span class="math inline">\(y\)</span> and <span class="math inline">\(x_1\)</span> values for each observation in our
data. For example, we may want to model the relationship between weight
and height. <span class="math inline">\(y\)</span> would represent
weight and <span class="math inline">\(x_1\)</span> would represent
height. After we fit the model, R will return to us values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> - these are <em>estimated</em>
using our data.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>We are asked to study the effect of participant’s age on their BMI.
We are given the following equation of a simple linear regression to
use:</p>
<p><span class="math display">\[E(y) = \\beta\_0 + \\beta\_1 \\times
x\_1\]</span>.</p>
<p>Match the following components of this simple linear regression model
to their descriptions:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E(y)\)</span></li>
<li><span class="math inline">\({\beta}_0\)</span></li>
<li><span class="math inline">\(x_1\)</span></li>
<li><span class="math inline">\({\beta}_1\)</span></li>
</ol>
<ol style="list-style-type: upper-alpha">
<li>Mean BMI at a particular value of age.<br>
</li>
<li>The expected BMI when the age equals 0.<br>
</li>
<li>The expected change in BMI with a one-unit increase in age.<br>
</li>
<li>A specific value of age.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ol style="list-style-type: upper-alpha">
<li>1<br>
</li>
<li>2<br>
</li>
<li>4<br>
</li>
<li>3</li>
</ol>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Simple linear regression requires one continuous dependent variable
and one continuous or categorical explanatory variable. In addition, the
assumptions of the model must hold.</li>
<li>The components of the model describe the mean of the dependent
variable as a function of the explanatory variables, the mean of the
dependent variable at the 0-point of the explanatory variable and the
effect of the explanatory variable on the mean of dependent
variable.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-02-singleContPred"><p>Content from <a href="02-singleContPred.html">Linear regression with one continuous explanatory variable</a></p>
<hr>
<p> Last updated on 2023-01-31 | 
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/02-singleContPred.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we assess whether simple linear regression is a suitable way
to model the relationship between two continuous variables?</li>
<li>How can we fit a simple linear regression model with one continuous
explanatory variable in R?</li>
<li>How can the parameters of this model be interpreted in R?</li>
<li>How can this model be visualised in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use the ggplot2 package to explore the relationship between two
continuous variables.</li>
<li>Use the lm command to fit a simple linear regression with one
continuous explanatory variable.</li>
<li>Use the jtools package to interpret the model output.</li>
<li>Use the jtools and ggplot2 packages to visualise the resulting
model.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In this episode we will study linear regression with one continuous
explanatory variable. As explained in the previous episode, the
explanatory variable is required to have a linear relationship with the
outcome variable. We can explore the relationship between two variables
ahead of fitting a model using the <code>ggplot2</code> package.</p>
<section id="exploring-the-relationship-between-two-continuous-variables"><h2 class="section-heading">Exploring the relationship between two continuous variables<a class="anchor" aria-label="anchor" href="#exploring-the-relationship-between-two-continuous-variables"></a>
</h2>
<hr class="half-width">
<p>Let us take <code>Weight</code> and <code>Height</code> of adults as
an example. In the code below, we select adult participants with the
command <code>filter(Age &gt; 17)</code>. We then initiate a plotting
object using <code>ggplot()</code>. The data is passed on to
<code>ggplot()</code> using the pipe. We then select the variables of
interest inside <code>aes()</code>. In the next line we create a
scatterplot using <code>geom_point()</code>. Finally, we modify the x
and y axis labels using <code>xlab()</code> and <code>ylab()</code>.
Note that the warning message “Removed 320 rows containing missing
values (geom_point)” means that there are participants without recorded
height and/or weight data.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span>, y <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Height (cm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Weight (kg)"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 320 rows containing missing values (`geom_point()`).</code></pre>
</div>
<figure><img src="fig/02-singleContPred-rendered-Height%20vs%20Weight%20plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>You have been asked to model the relationship between average
systolic blood pressure and age in adults in the NHANES data. In order
to fit a simple linear regression model, you first need to confirm that
the relationship between these variables appears linear. Use the ggplot2
package to create a plot, ensuring that it includes the following
elements:</p>
<ol style="list-style-type: decimal">
<li>Average systolic blood pressure (<code>BPSysAve</code>) on the
y-axis and age (<code>AgeMonths</code>) on the x-axis, from the NHANES
data, only including data from individuals over the age of 17.</li>
<li>These data are presented using a scatterplot.</li>
<li>The y-axis labelled as “Average systolic blood pressure (mmHg)” and
the x-axis labelled as “Age (months)”.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">AgeMonths</span>, y <span class="op">=</span> <span class="va">BPSysAve</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Average systolic blood pressure (mmHg)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age (months)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02-singleContPred-rendered-explore%20BPSysAve%20vs%20AgeMonths-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="fitting-and-interpreting-a-simple-linear-regression-model-with-one-continuous-explanatory-variable"><h2 class="section-heading">Fitting and interpreting a simple linear regression model with one
continuous explanatory variable<a class="anchor" aria-label="anchor" href="#fitting-and-interpreting-a-simple-linear-regression-model-with-one-continuous-explanatory-variable"></a>
</h2>
<hr class="half-width">
<p>Since there is no abnormal shape to the scatterplot (e.g. curvature
or multiple clusters), we can proceed with fitting our linear regression
model. First, we subset our data using <code>filter()</code>. We then
fit the simple linear regression model with the <code>lm()</code>
command. Within the command, the model is denoted by
<code>formula = outcome variable ~ explanatory variable</code>.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span></code></pre>
</div>
<p>We will interpret our results using a summary table and a plot. The
summary table can be obtained using the <code>summ()</code> function
from the <code>jtools</code> package. We provide the function with the
name of our model (<code>Weight_Height_lm</code>). We can also specify
that we want confidence intervals for our parameter estimates using
<code>confint = TRUE</code>. Finally, we specify that we want estimates
with three digits after the decimal point with
<code>digits = 3</code>.</p>
<p>We will come to interpreting the <code>Model Fit</code> section in a
later episode. For now, take a look at the parameter estimates at the
bottom of the output. We see that the intercept (i.e. <span class="math inline">\(\beta_0\)</span>) is estimated at -70.194 and the
effect of <code>Height</code> (i.e. <span class="math inline">\(\beta_1\)</span>) is estimated at 0.901. The model
therefore predicts an average increase in <code>Weight</code> of 0.901
kg for every 1 cm increase in <code>Height</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summ</span><span class="op">(</span><span class="va">Weight_Height_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 6177 (320 missing obs. deleted)
Dependent Variable: Weight
Type: OLS linear regression 

MODEL FIT:
F(1,6175) = 1398.215, p = 0.000
R² = 0.185
Adj. R² = 0.184 

Standard errors: OLS
-----------------------------------------------------------------
                       Est.      2.5%     97.5%    t val.       p
----------------- --------- --------- --------- --------- -------
(Intercept)         -70.194   -78.152   -62.237   -17.293   0.000
Height                0.901     0.853     0.948    37.393   0.000
-----------------------------------------------------------------</code></pre>
</div>
<p>We can therefore write the formula as:</p>
<p><span class="math display">\[E(\\text{Weight}) = -70.19 + 0.901
\\times \\text{Height}\]</span></p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="interpretation-of-the-95-ci-and-p-value-of-height" class="callout-inner">
<h3 class="callout-title">Interpretation of the 95% CI and p-value of
<code>Height</code><a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>If <em>prior to fitting our model</em> we were interested in testing
the hypotheses <span class="math inline">\(H_0: \beta_1 = 0\)</span> vs
<span class="math inline">\(H_1: \beta_1 \neq 0\)</span>, we could check
the 95% CI for <code>Height</code>. Recall that 95% of 95% CIs are
expected to contain the true population mean. Since this 95% CI does not
contain 0, we would be fairly confident in rejecting <span class="math inline">\(H_0\)</span> in favour of <span class="math inline">\(H_1\)</span>. Alternatively, since the p-value is
less than 0.05, we could reject <span class="math inline">\(H_0\)</span>
on those grounds.</p>
<p>Note that the <code>summ()</code> output below shows
<code>p = 0.000</code>. P values are never truly zero. The
interpretation of <code>p = 0.000</code> is therefore that
<code>p &lt; 0.001</code>, as the p-value was rounded to three
digits.</p>
<p>Often the null hypothesis tested by <code>summ()</code>, <span class="math inline">\(H_0: \beta_1 = 0\)</span>, is not very
interesting, as it is rare that we expect a variable to have an effect
of 0. Therefore, it is usually not necessary to pay great attention to
the p-value. On the other hand, the 95% CI can still be useful, as it
provides an estimate of the <em>uncertainty</em> around our estimate for
<span class="math inline">\(\beta_1\)</span>. The narrower the 95% CI,
the more certain we are that our estimate for <span class="math inline">\(\beta_1\)</span> is close to the population mean
for <span class="math inline">\(\beta_1\)</span>.</p>
</div>
</div>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>Now that you have confirmed that the relationship between
<code>BPSysAve</code> and <code>AgeMonths</code> does not appear to
deviate from linearity in the NHANES data, you can proceed to fitting a
simple linear regression model.</p>
<ol style="list-style-type: decimal">
<li>Using the <code>lm()</code> command, fit a simple linear regression
of average systolic blood pressure (<code>BPSysAve</code>) as a function
of age in months (<code>AgeMonths</code>) in adults. Name this
<code>lm</code> object <code>BPSysAve_AgeMonths_lm</code>.</li>
<li>Using the <code>summ</code> function from the <code>jtools</code>
package, answer the following questions:</li>
</ol>
<ol style="list-style-type: upper-alpha">
<li>What average systolic blood pressure does the model predict, on
average, for an individual with an age of 0 months?<br>
</li>
<li>By how much is average systolic blood pressure expected to change,
on average, for a one-unit increase in age?<br>
</li>
<li>Given these two values and the names of the response and explanatory
variables, how can the general equation <span class="math inline">\(E(y)
= \beta_0 + {\beta}_1 \times x_1\)</span> be adapted to represent your
model?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPSysAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPSysAve</span> <span class="op">~</span> <span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 3084 (3413 missing obs. deleted)
Dependent Variable: BPSysAve
Type: OLS linear regression 

MODEL FIT:
F(1,3082) = 556.405, p = 0.000
R² = 0.153
Adj. R² = 0.153 

Standard errors: OLS
-----------------------------------------------------------------
                       Est.      2.5%     97.5%    t val.       p
----------------- --------- --------- --------- --------- -------
(Intercept)         101.812   100.166   103.458   121.276   0.000
AgeMonths             0.033     0.030     0.035    23.588   0.000
-----------------------------------------------------------------</code></pre>
</div>
<ol style="list-style-type: upper-alpha">
<li>101.8 mmHg.<br>
</li>
<li>Increase by 0.033 mmHg/month.<br>
</li>
<li>
<span class="math inline">\(E(\text{Average systolic blood
pressure}) = 101.8 + 0.033 \times \text{Age in Months}\)</span>.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="visualising-a-simple-linear-regression-model-with-one-continuous-explanatory-variable"><h2 class="section-heading">Visualising a simple linear regression model with one continuous
explanatory variable<a class="anchor" aria-label="anchor" href="#visualising-a-simple-linear-regression-model-with-one-continuous-explanatory-variable"></a>
</h2>
<hr class="half-width">
<p>We can also interpret the model using a line overlayed onto the
previous scatterplot. We can obtain such a plot using
<code>effect_plot()</code> from the <code>jtools</code> package. We
provide the name of our model, followed by a specification of the
explanatory variable of interest with <code>pred = Height</code>. Our
current model has one explanatory variable, but in later lessons we will
work with multiple explanatory variables so this option will be more
useful. We also include a confidence interval around our line using
<code>interval = TRUE</code> and include the original data using
<code>plot.points = TRUE</code>. Finally, we specify a red colour for
our line using <code>colors = "red"</code>. As before, we can edit the x
and y axis labels.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">Weight_Height_lm</span>, pred <span class="op">=</span> <span class="va">Height</span>, plot.points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            interval <span class="op">=</span> <span class="cn">TRUE</span>, line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Height (cm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Weight (kg)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02-singleContPred-rendered-effect%20plot%20weight%20vs%20height-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>You have been asked to report on your simple linear regression model,
examining systolic blood pressure and age, at the next lab meeting. To
help your colleagues interpret the model, you decide to produce a
figure. Make this figure using the jtools package. Ensure that the x and
y axes are correctly labelled.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span>, pred <span class="op">=</span> <span class="va">AgeMonths</span>, plot.points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            interval <span class="op">=</span> <span class="cn">TRUE</span>, line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age (months)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Average systolic blood pressure (mmHg)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02-singleContPred-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>As a first check of suitability, examine the relationship between
the continuous variables using a scatterplot.</li>
<li>Use <code>lm()</code> to fit a simple linear regression model.</li>
<li>Use <code>summ()</code> to obtain parameter estimates for the
model.</li>
<li>Use <code>effect_plot()</code> to visualise the model.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-twoLvlFactor"><p>Content from <a href="03-twoLvlFactor.html">Linear regression with a two-level factor explanatory variable</a></p>
<hr>
<p> Last updated on 2023-01-31 | 
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/03-twoLvlFactor.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we explore the relationship between one continuous variable
and one categorical variable with two groups prior to fitting a simple
linear regression?</li>
<li>How can we fit a simple linear regression model with one two-level
categorical explanatory variable in R?</li>
<li>How does the use of the simple linear regression equation differ
between the continuous and categorical explanatory variable cases?</li>
<li>How can the parameters of this model be interpreted in R?</li>
<li>How can this model be visualised in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use the ggplot2 package to explore the relationship between a
continuous variable and a two-level factor variable.</li>
<li>Use the lm command to fit a simple linear regression with a
two-level factor explanatory variable.</li>
<li>Distinguish between the baseline and contrast levels of the
categorical variable.</li>
<li>Use the jtools package to interpret the model output.</li>
<li>Use the jtools and ggplot2 packages to visualise the resulting
model.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In this episode we will study linear regression with one two-level
categorical variable. We can explore the relationship between two
variables ahead of fitting a model using the <code>ggplot2</code>
package.</p>
<section id="exploring-the-relationship-between-a-continuous-variable-and-a-two-level-categorical-variable"><h2 class="section-heading">Exploring the relationship between a continuous variable and a
two-level categorical variable<a class="anchor" aria-label="anchor" href="#exploring-the-relationship-between-a-continuous-variable-and-a-two-level-categorical-variable"></a>
</h2>
<hr class="half-width">
<p>Let us take <code>SmokeNow</code> and <code>TotChol</code> as an
example. <code>SmokeNow</code> describes whether someone who has smoked
&gt; 100 cigarettes in their life is currently smoking.
<code>TotChol</code> describes the total HDL cholesterol in someone’s
blood. In the code below, we first remove rows with missing values using
<code>drop_na()</code> from the <code>tidyr</code> package. We then
initiate a plotting object using <code>ggplot</code>. We select the
variables of interest inside <code>aes()</code>. We then make a violin
plot using <code>geom_violin</code>. The shapes of the objects are
representative of the distributions of <code>TotChol</code> in the two
groups. We overlay the means and their 95% confidence intervals using
<code>stat_summary()</code>. Finally, we change the axis labels using
<code>xlab()</code> and <code>ylab()</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">SmokeNow</span>, <span class="va">TotChol</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">SmokeNow</span>, y <span class="op">=</span> <span class="va">TotChol</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_cl_normal"</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Participant still smoking"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Total HDL Cholesterol"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/03-twoLvlFactor-rendered-SmokeNow%20vs%20TotChol%20violin-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="notes-on-the-fun-and-fun.data-arguments-in-stat_summary" class="callout-inner">
<h3 class="callout-title">Notes on the <code>fun</code> and
<code>fun.data</code> arguments in <code>stat_summary()</code><a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>The <code>fun</code> and <code>fun.data</code> arguments both apply
statistical operations to data but do slightly different things.
<code>fun</code> takes data as vectors and will return single values for
each these vectors. In the above example, we calculate the mean for each
vector (each <code>SmokeNow</code> group). <code>fun.data</code> expects
a dataset (which may be a simple vector) and provides three values for
each dataset: <code>y</code>, <code>ymin</code> and <code>ymax</code>.
In our case, ymin is lower bound of the confidence interval and ymax is
the upper bound of the confidence interval.</p>
</div>
</div>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>You have been asked to model the relationship between average
systolic blood pressure and physical activity in the NHANES data. Use
the ggplot2 package to create an exploratory plot, ensuring that it
includes the following elements:</p>
<ol style="list-style-type: decimal">
<li>Average systolic blood pressure (<code>BPSysAve</code>) on the
y-axis and physical activity (<code>PhysActive</code>) on the x-axis,
from the NHANES data.</li>
<li>These data presented using a violin plot.</li>
<li>The y-axis labelled as “Average Systolic Blood Pressure” and the
x-axis labelled as “Physically Active”.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">PhysActive</span>, <span class="va">BPSysAve</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">PhysActive</span>, y <span class="op">=</span> <span class="va">BPSysAve</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_cl_normal"</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Physically Active"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Average Systolic Blood Pressure"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/03-twoLvlFactor-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="fitting-and-interpreting-a-simple-linear-regression-model-with-one-two-level-categorical-variable"><h2 class="section-heading">Fitting and interpreting a simple linear regression model with one
two-level categorical variable<a class="anchor" aria-label="anchor" href="#fitting-and-interpreting-a-simple-linear-regression-model-with-one-two-level-categorical-variable"></a>
</h2>
<hr class="half-width">
<p>We proceed to fit a linear regression model using the
<code>lm()</code> command, as we did in the previous episode. The model
is then interpreted using <code>summ()</code>.</p>
<p>Note that even though we are using the same equation of the simple
linear regression model (<span class="math inline">\(E(y) = \beta_0 +
\beta_1 \times x_1\)</span>), our interpretation of the
<code>summ()</code> output differs slightly from our interpretation in
the previous episode. Recall that our categorical explanatory variable
has two levels, <code>"No"</code> and <code>"Yes"</code>. One of these
is taken by the model as the baseline (<code>"No"</code>), the other as
the contrast (<code>"Yes"</code>). The first level alphabetically is
chosen by R as the baseline, unless specified otherwise.</p>
<p>The intercept in the <code>summ()</code> output is the estimated mean
for the baseline, i.e. for participants that stopped smoking. The
<code>SmokeNowYes</code> estimate is the estimated average difference in
<code>TotChol</code> between participants that stopped smoking and
participants that did not stop smoking. We can therefore write the
equation for this model as:</p>
<p><span class="math display">\[E(\\text{Total HDL cholesterol}) = 5.053
+ 0.008 \\times x\_1\]</span>,</p>
<p>where <span class="math inline">\(x_1 = 1\)</span> if a participant
has continued to smoke and 0 otherwise (i.e. the participant stopped
smoking).</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TotChol_SmokeNow_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">TotChol</span> <span class="op">~</span> <span class="va">SmokeNow</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">TotChol_SmokeNow_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 2741 (7259 missing obs. deleted)
Dependent Variable: TotChol
Type: OLS linear regression 

MODEL FIT:
F(1,2739) = 0.031, p = 0.861
R² = 0.000
Adj. R² = -0.000 

Standard errors: OLS
------------------------------------------------------------
                     Est.     2.5%   97.5%    t val.       p
----------------- ------- -------- ------- --------- -------
(Intercept)         5.053    4.995   5.111   170.707   0.000
SmokeNowYes         0.008   -0.078   0.094     0.175   0.861
------------------------------------------------------------</code></pre>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Using the <code>lm()</code> command, fit a simple linear regression
of average systolic blood pressure (<code>BPSysAve</code>)<br>
as a function of physical activity (<code>PhysActive</code>). Name this
<code>lm</code> object <code>BPSysAve_PhysActive_lm</code>.</li>
<li>Using the <code>summ()</code> function from the <code>jtools</code>
package, answer the following questions:</li>
</ol>
<ol style="list-style-type: upper-alpha">
<li>What average systolic blood pressure does the model predict, on
average, for an individual who is not physically active?<br>
</li>
<li>By how much is average systolic blood pressure expected to change,
on average, for a physically active individual?<br>
</li>
<li>Given these two values and the names of the response and explanatory
variables, how can the general equation <span class="math inline">\(E(y)
= \beta_0 + {\beta}_1 \times x_1\)</span> be adapted to represent this
model?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPSysAve_PhysActive_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPSysAve</span> <span class="op">~</span> <span class="va">PhysActive</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">BPSysAve_PhysActive_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 6781 (3219 missing obs. deleted)
Dependent Variable: BPSysAve
Type: OLS linear regression 

MODEL FIT:
F(1,6779) = 133.611, p = 0.000
R² = 0.019
Adj. R² = 0.019 

Standard errors: OLS
-------------------------------------------------------------------
                         Est.      2.5%     97.5%    t val.       p
------------------- --------- --------- --------- --------- -------
(Intercept)           122.892   122.275   123.509   390.285   0.000
PhysActiveYes          -5.002    -5.851    -4.154   -11.559   0.000
-------------------------------------------------------------------</code></pre>
</div>
<ol style="list-style-type: upper-alpha">
<li>122.892 mmHg<br>
</li>
<li>Decrease by 5.002 mmHg<br>
</li>
<li>
<span class="math inline">\(E(\text{BPSysAve}) = 122.892 - 5.002
\times x_1\)</span>, where <span class="math inline">\(x_1 = 0\)</span>
if an individual is not physically active and <span class="math inline">\(x_1 = 1\)</span> if an individual is physically
active.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="visualising-a-simple-linear-regression-model-with-one-two-level-categorical-explanatory-variable"><h2 class="section-heading">Visualising a simple linear regression model with one two-level
categorical explanatory variable<a class="anchor" aria-label="anchor" href="#visualising-a-simple-linear-regression-model-with-one-two-level-categorical-explanatory-variable"></a>
</h2>
<hr class="half-width">
<p>Finally, we visually inspect the parameter estimates provided by our
model. Again we can use <code>effect_plot()</code> from the
<code>jtools</code> package. We include <code>jitter = c(0.3, 0)</code>
and <code>point.alpha = 0.2</code> so that points are spread out
HORIZONTALLY and so that multiple overlayed points create a darker
colour, respectively. The resulting plot differs from the scatterplot
obtained in the previous episode. Here, the plot shows the mean Total
HDL Cholesterol estimates for each level of <code>SmokeNow</code>, with
their 95% confidence intervals. This allows us to see how different the
means are predicted to be and within what range we can expect the true
population means to fall.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">TotChol_SmokeNow_lm</span>, pred <span class="op">=</span> <span class="va">SmokeNow</span>,</span>
<span>            plot.points <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span>, point.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Participant still smoking"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Total HDL Cholesterol"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/03-twoLvlFactor-rendered-SmokeNow%20vs%20TotChol%20effect_plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="callout2" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="notes-on-jitter-and-point.alpha" class="callout-inner">
<h3 class="callout-title">Notes on <code>jitter</code> and
<code>point.alpha</code><a class="anchor" aria-label="anchor" href="#callout2"></a>
</h3>
<div class="callout-content">
<p>Including <code>jitter = c(0.3, 0)</code> results in points being
<em>randomly</em> jittered horizontally. Therefore, your plot will
differ slightly from the one shown above. Re-running the code will also
give a slightly different jitter. If you would want to fix the
<code>jitter</code> to one randomisation, you could run a
<code>set.seed()</code> command ahead of <code>effect_plot</code>.
<code>set.seed()</code> takes one positive value, which specifies the
randomisation. This can be any positive value. For example, if you run
the code below, your jitter will match the one shown on this page:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="co">#fix the jitter to a particular pattern</span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">TotChol_SmokeNow_lm</span>, pred <span class="op">=</span> <span class="va">SmokeNow</span>,</span>
<span>            plot.points <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span>, point.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Participant still smoking"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Total HDL Cholesterol"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/03-twoLvlFactor-rendered-SmokeNow%20vs%20TotChol%20effect_plot%20with%20set%20seed-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Including <code>point.alpha = 0.2</code> introduces opacity into the
plotted points. As a result, if many points are plotted on top of each
other, this area shows up with darker dots. Including opacity allows us
to see where many of the points lie, which is handy with big public
health data sets.</p>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>Use the <code>jtools</code> package to visualise the model of
<code>BPSysAve</code> as a function of <code>PhysActive</code>.<br>
Ensure that the x-axis is labelled as “Physically active” and the y-axis
is labelled as “Average Systolic Blood Pressure”. How does this plot
relate to the output given by <code>summ</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">BPSysAve_PhysActive_lm</span>, pred <span class="op">=</span> <span class="va">PhysActive</span>,</span>
<span>plot.points <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span>, point.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Physically Active"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Average Systolic Blood Pressure"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/03-twoLvlFactor-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This plot shows the mean estimates for <code>BPSysAve</code> for the
two groups, alongside their 95% confidence intervals. The mean estimates
are represented by the <code>Intercept</code> for the non-physically
active group and by <code>Intercept</code> + <code>PhysActiveYes</code>
for the physically active group.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>As a first exploration of the data, construct a violin plot
describing the relationship between the two variables.</li>
<li>Use <code>lm()</code> to fit a simple linear regression model.</li>
<li>Use <code>summ()</code> to obtain parameter estimates for the
model.</li>
<li>The intercept estimates the mean in the outcome variable for the
baseline group. The other parameter estimates the difference in the
means in the outcome variable between the baseline and contrast
group.</li>
<li>Use <code>effect_plot()</code> to visualise the estimated means per
group along with their 95% CIs.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-04-predictionSLR"><p>Content from <a href="04-predictionSLR.html">Making predictions from a simple linear regression model</a></p>
<hr>
<p> Last updated on 2023-01-31 | 
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/04-predictionSLR.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can predictions be manually obtained from a simple linear
regression model?</li>
<li>How can R be used to obtain predictions from a simple linear
regression model?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Calculate a prediction from a simple linear regression model using
parameter estimates given by the model output.</li>
<li>Use the predict function to generate predictions from a simple
linear regression model.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>One of the features of linear regression is prediction: a model
presents predicted mean values for the outcome variable for any values
of the explanatory variables. We have already seen this in the previous
episodes through our <code>effect_plot()</code> outputs, which showed
mean predicted responses as straight lines (episode 2) or individual
points for levels of a categorical variable (episodes 3). Here, we will
see how to obtain predicted values and the uncertainty surrounding
them.</p>
<section id="calculating-predictions-manually"><h2 class="section-heading">Calculating predictions manually<a class="anchor" aria-label="anchor" href="#calculating-predictions-manually"></a>
</h2>
<hr class="half-width">
<p>First, we can calculate a predicted value manually. From the
<code>summ()</code> output associated with our
<code>Weight_Height_lm</code> model from episode 2, we can write the
model as <span class="math inline">\(E(\text{Weight}) = \beta_0 +
\beta_1 \times \text{Height} = -70.194 + 0.901 \times
\text{Height}\)</span>. The output can be found again below. If we take
a height of 165 cm, then our model predicts an average weight of <span class="math inline">\(-70.194 + 0.901 \times 165 = 78.471\)</span>
kg.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">Weight_Height_lm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 6177 (320 missing obs. deleted)
Dependent Variable: Weight
Type: OLS linear regression 

MODEL FIT:
F(1,6175) = 1398.22, p = 0.00
R² = 0.18
Adj. R² = 0.18 

Standard errors: OLS
-------------------------------------------------
                      Est.   S.E.   t val.      p
----------------- -------- ------ -------- ------
(Intercept)         -70.19   4.06   -17.29   0.00
Height                0.90   0.02    37.39   0.00
-------------------------------------------------</code></pre>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>Given the <code>summ</code> output from our
<code>BPSysAve_AgeMonths_lm</code> model, the model can be described
as</p>
<p><span class="math inline">\(E(\text{BPSysAve}) = \beta_0 + \beta_1
\times \text{Age (months)} = 101.812 + 0.033 \times \text{Age
(months)}\)</span>.</p>
<p>What level of average systolic blood pressure does the model predict,
on average, for an individual with an age of 480 months?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p><span class="math inline">\(101.812 + 0.033 * 480 = 117.652
\text{mmHg}\)</span>.</p>
</div>
</div>
</div>
</div>
</section><section id="making-predictions-using-make_predictions"><h2 class="section-heading">Making predictions using <code>make_predictions()</code><a class="anchor" aria-label="anchor" href="#making-predictions-using-make_predictions"></a>
</h2>
<hr class="half-width">
<p>Using the <code>make_predictions()</code> function brings two
advantages. First, when calculating multiple predictions, we are saved
the effort of inserting multiple values into our model manually and
doing the calculations. Secondly, <code>make_predictions()</code>
returns 95% confidence intervals around the predictions, giving us a
sense of the uncertainty around the predictions.</p>
<p>To use <code>make_predictions()</code>, we need to create a
<code>tibble</code> with the explanatory variable values for which we
wish to have mean predictions from the model. We do this using the
<code>tibble()</code> function. Note that the column name must
correspond to the name of the explanatory variable in the model,
i.e. <code>Height</code>. In the code below, we create a
<code>tibble</code> with the values 150, 160, 170 and 180. We then
provide <code>make_predictions()</code> with this <code>tibble</code>,
alongside the model from which we wish to have predictions. By default,
95% confidence intervals are returned.</p>
<p>We see that the model predicts an average weight of 64.88 kg for an
individual with a height of 150 cm, with a 95% confidence interval of
[63.9kg, 65.9kg].</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Heights</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>Height <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">150</span>, <span class="fl">160</span>, <span class="fl">170</span>, <span class="fl">180</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">make_predictions</span><span class="op">(</span><span class="va">Weight_Height_lm</span>, new_data <span class="op">=</span> <span class="va">Heights</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4 × 4
  Height Weight  ymin  ymax
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    150   64.9  63.9  65.9
2    160   73.9  73.3  74.5
3    170   82.9  82.4  83.4
4    180   91.9  91.2  92.6</code></pre>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Using the <code>make_predictions()</code> function, obtain the
expected mean average systolic blood pressure levels predicted by the
<code>BPSysAve_AgeMonths_lm</code> model for individuals with an age of
300, 400, 500 and 600 months.</li>
<li>Obtain 95% confidence intervals for these predictions.</li>
<li>How are these confidence intervals interpreted?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPSysAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> </span>
<span> <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span> <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPSysAve</span> <span class="op">~</span> <span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>AgeMonths <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">300</span>, <span class="fl">400</span>, <span class="fl">500</span>, <span class="fl">600</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">make_predictions</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span>, new_data <span class="op">=</span> <span class="va">ages</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4 × 4
  AgeMonths BPSysAve  ymin  ymax
      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1       300     112.  111.  113.
2       400     115.  114.  116.
3       500     118.  118.  119.
4       600     121.  121.  122.</code></pre>
</div>
<p>Recall that 95% of 95% confidence intervals are expected to contain
the population mean. Therefore, we can be fairly confident that the true
population means lie somewhere between the bounds of the intervals,
assuming that our model is good.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Predictions of the mean in the outcome variable can be manually
calculated using the model’s equation.</li>
<li>Predictions of multiple means in the outcome variable alongside 95%
CIs can be obtained using the <code>make_predictions()</code>
function.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-05-fitAndAssumptionSLR"><p>Content from <a href="05-fitAndAssumptionSLR.html">Assessing simple linear regression model fit and assumptions</a></p>
<hr>
<p> Last updated on 2023-01-31 | 
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/05-fitAndAssumptionSLR.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What does it mean to assess model fit?</li>
<li>What does <span class="math inline">\(R^2\)</span> quantify and how
is it interpreted?</li>
<li>What are the six assumptions of simple linear regression?</li>
<li>How do I check if any of these assumptions are violated?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what is meant by model fit.</li>
<li>Use the <span class="math inline">\(R^2\)</span> value as a measure
of model fit.</li>
<li>Describe the assumptions of the simple linear regression model.</li>
<li>Assess whether the assumptions of the simple linear regression model
have been violated.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In this episode we will learn what is meant by model fit, how to
interpret the <span class="math inline">\(R^2\)</span> measure of model
fit and how to assess whether our model meets the assumptions of simple
linear regression. This episode was inspired by chapter 11 of the book
Regression and Other Stories (see <a href="https://users.aalto.fi/~ave/ROS.pdf" class="external-link">here</a> for a pdf copy).</p>
<section id="using-residuals-to-assess-model-fit"><h2 class="section-heading">Using residuals to assess model fit<a class="anchor" aria-label="anchor" href="#using-residuals-to-assess-model-fit"></a>
</h2>
<hr class="half-width">
<p>Broadly speaking, when we assess model fit we are checking whether
our model fits the data sufficiently well. This process is somewhat
subjective, in that the majority of our assessments are performed
visually. While there are many ways to assess model fit, we will cover
two main components:</p>
<ol style="list-style-type: decimal">
<li>Calculation of the variance in the response variable explained by
the model, <span class="math inline">\(R^2\)</span>.</li>
<li>Assessment of the assumptions of the simple linear regression
model.</li>
</ol>
<p>Both of these components rely on the use of <em>residuals</em>.
Recall that our model is characterized by a line, which predicts a value
for the outcome variable for each value of the explanatory variable. The
<em>difference</em> between an observed outcome and a predicted outcome
is a residual. Therefore, our model has as many residuals as the number
of observations used in fitting the model.</p>
<p>For a visual example of residuals, see the plot below. A simple
linear regression was fit to <code>Height</code> and <code>Weight</code>
data of participants with an <code>Age</code> of 25. To the right side,
we see a long red vertical line. This is a relatively large residual,
for an individual with a weight greater than predicted by the model. To
the left side, we see a shorter red vertical line. This is a relatively
small residual, for an individual with a weight close to that predicted
by the model.</p>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-residual%20example-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="measuring-model-fit-using-r2"><h2 class="section-heading">Measuring model fit using <span class="math inline">\(R^2\)</span><a class="anchor" aria-label="anchor" href="#measuring-model-fit-using-r2"></a>
</h2>
<hr class="half-width">
<p>A commonly used summary statistic for model fit is <span class="math inline">\(R^2\)</span>, which quantifies the proportion of
variation in the outcome variable explained by the explanatory variable.
An <span class="math inline">\(R^2\)</span> close to 1 indicates that
the model accounts for most of the variation in the outcome variable. An
<span class="math inline">\(R^2\)</span> close to 0 indicates that most
of the variation in the outcome variable is not accounted for by the
model.</p>
<p>What does it mean when a model accounts for most of the variation in
the outcome variable? Or when it does not? Let’s look at examples of the
two extremes: <span class="math inline">\(R^2=1\)</span> and <span class="math inline">\(R^2=0\)</span>. In these cases, 100% and 0% of the
variation in the outcome variable is accounted for by the explanatory
variable, respectively.</p>
<p>Below is a plot of hypothetical data, with two regression lines. The
blue line goes perfectly through the data points, while the red line is
horizontal at the mean of the hypothetical data.</p>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-R%20squared%20extremes%20visualised-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>When a model accounts for all of the variation in the outcome
variable, the line goes perfectly through the data points. When a model
does not account for any of the variation in the outcome variable, the
model predicts the mean of the outcome variable, regardless of the
explanatory variable.</p>
<p>Usually our <span class="math inline">\(R^2\)</span> value will lie
somewhere between these two extremes. An <span class="math inline">\(R^2\)</span> close to 1 indicates that the data
does not scatter much around the model line. Therefore, our model
accounts for most of the variation in the outcome variable. An <span class="math inline">\(R^2\)</span> close to 0 indicates that our model
does not predict much better than the mean of the response variable.
Therefore, our model does not account for much of the variation in the
outcome variable. See for example plots below. The points in the left
plot lie closer to the line, so the model explains more of the variation
and the <span class="math inline">\(R^2\)</span> value is higher.</p>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-examples%20of%20R%20squared-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The cut-off for a “good” <span class="math inline">\(R^2\)</span>
value varies by research question and data set. There are scenarios in
which explaining 10% of the variation in an outcome variable is “good”,
while there are others where we may only be satisfied with much higher
<span class="math inline">\(R^2\)</span> values. The most important
thing is to not blindly rely on <span class="math inline">\(R^2\)</span>
as a measure of model fit. While it is a useful assessment, it needs to
be interpreted in the context of the research question and the
assumptions of the model used.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Find the R-squared value for the <code>summ</code> output of our
<code>BPSysAve_AgeMonths_lm</code> model from <a href="https://carpentries-incubator.github.io/simple-linear-regression-public-health/02-singleContPred" class="external-link">episode
2</a>.</li>
<li>What proportion of variation in average systolic blood pressure is
explained by age in our model?</li>
<li>Does our model account for most of the variation in
<code>BPSysAve</code>?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPSysAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPSysAve</span> <span class="op">~</span> <span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 3084 (3413 missing obs. deleted)
Dependent Variable: BPSysAve
Type: OLS linear regression 

MODEL FIT:
F(1,3082) = 556.405, p = 0.000
R² = 0.153
Adj. R² = 0.153 

Standard errors: OLS
-----------------------------------------------------------------
                       Est.      2.5%     97.5%    t val.       p
----------------- --------- --------- --------- --------- -------
(Intercept)         101.812   100.166   103.458   121.276   0.000
AgeMonths             0.033     0.030     0.035    23.588   0.000
-----------------------------------------------------------------</code></pre>
</div>
<p>Since <span class="math inline">\(R^2 = 0.153\)</span>, our model
accounts for approximately 15% of the variation in
<code>BPSysAve</code>. Our model explains 15% of the variation on
<code>BPSysAve</code>, which a model that always predicts the mean would
not.</p>
</div>
</div>
</div>
</div>
</section><section id="assessing-the-assumptions-of-simple-linear-regression"><h2 class="section-heading">Assessing the assumptions of simple linear regression<a class="anchor" aria-label="anchor" href="#assessing-the-assumptions-of-simple-linear-regression"></a>
</h2>
<hr class="half-width">
<p>Simple linear regression has six assumptions. We will discuss these
below and explore how to check that they are not violated through a
series of challenges with applied examples.</p>
<div class="section level3">
<h3 id="validity">1. Validity<a class="anchor" aria-label="anchor" href="#validity"></a>
</h3>
<p>The validity assumption states that the model is appropriate for the
research question. This may sound obvious, but it is easy to come to
unreliable conclusions because of inappropriate model choice. Validity
is assessed in three ways:</p>
<ol style="list-style-type: upper-alpha">
<li>Does the outcome variable reflect the <em>phenomenon of
interest</em>? For example, it would not be appropriate to take our
<code>Pulse</code> vs <code>PhysActive</code> model as representative of
the effect of physical activity on general health.<br>
</li>
<li>Does the model include <em>all relevant explanatory variables</em>?
For example, we might decide that our model of <code>TotChol</code> vs
<code>BMI</code> requires inclusion of the <code>SmokeNow</code>
variable. While not discussed in this lesson, inclusion of more than one
explanatory variable is covered in the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health/" class="external-link">multiple
linear regression for public health</a> lesson.<br>
</li>
<li>Does the model generalise to our <em>case of interest</em>? For
example, it would not be appropriate to use our <code>Pulse</code> vs
<code>PhysActive</code> model, which was constructed using people of all
ages, if we were specifically interested in the effect of physical
activity on pulse rate in those aged 70+. A subsample of the NHANES data
may allow us to answer the research question.</li>
</ol>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>You are asked to model the effect of age on general health of
South-Americans. A colleague proposes that you fit a simple linear
regression to the NHANES data, using <code>BMI</code> as the outcome
variable and <code>Age</code> as the explanatory variable. Using the
three points above, assess the validity of this model for the research
question.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em><a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: upper-alpha">
<li>There is more to general health than <code>BMI</code> alone. In this
case, we may wish to use a different outcome variable. Alternatively, we
could make the research question more specific by specifying that we are
studying the effect of <code>Age</code> on <code>BMI</code> rather than
general health.<br>
</li>
<li>Since we are specifically asked to study the effect of
<code>Age</code> on general health, we may conclude that no further
explanatory variables are relevant to the research question. However,
there may still be explanatory variables that are important to include,
such as income or sex, if the effect of <code>Age</code> on general
health depends on other explanatory variables. This will be covered in
the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health/" class="external-link">next
lesson</a>.<br>
</li>
<li>Since the NHANES data was collected from individuals in the US, this
data may not be suitable for a research question relating to individuals
in South-America.</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="representativeness">2. Representativeness<a class="anchor" aria-label="anchor" href="#representativeness"></a>
</h3>
<p>The representativeness assumption states that the <em>sample</em> is
representative of the <em>population</em> to which we are generalising
our findings. For example, if we were studying the relationship between
physical activity and pulse rate in US adults using the NHANES data, we
could assume that our sample is representative of our population of
interest. However, if we were to use data from a survey of care homes,
our data would not be representative of our population of interest: we
would have an overrepresentation of older people, compared to the US
adult population.</p>
<p>In combination with the <em>case of interest</em> criterium of the
<em>validity</em> assumption, we therefore ask:</p>
<ol style="list-style-type: decimal">
<li>Are the individuals on which our data was collected a subset of the
population of individuals which we are interested in studying? This is a
component of validity.</li>
<li>Is our sample of individuals representative of the population of
interest in terms of the number of individuals in relevant categories,
e.g. ages? This is representativeness.</li>
</ol>
<p>Note that when the representativeness assumption is violated, this
can be solved by including the misrepresented feature as an explanatory
variable in the model. For example, if the sample and the population
have different age distributions, age can be included as a variable in
the model. Linear regression with multiple explanatory variables is
covered in the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health" class="external-link">multiple
linear regression lesson</a>.</p>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>One of your colleagues is asked to model the effect of income on
dissertation grade in final year undergraduate students. They decide to
survey 500 students at your university, asking them for their income and
recording their grade upon completion of the thesis.</p>
<ol style="list-style-type: upper-alpha">
<li>Would fitting a model of thesis grade as a function of income using
this data violate the case of interest criterium of the validity
assumption?</li>
</ol>
<p>After completing the survey, your colleague finds that the proportion
of participants identifying as female in the data is 70%. Presume it is
known that at your university, 55% of final year undergraduate students
identify as female.</p>
<ol start="2" style="list-style-type: upper-alpha">
<li>Would fitting a model of thesis grade as a function of income using
this data violate the representativeness assumption?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: upper-alpha">
<li>Since the sample appears to be a subset of the population of
interest, the case of interest criterium would not be violated.<br>
</li>
<li>Since the sample is not representative of the population of
interest, the representativeness assumption would be violated. Including
a variable for gender may solve the violation. See the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health" class="external-link">multiple
linear regression lesson</a> for details on how to include multiple
variables in linear regression.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="linearity-and-additivity">3. Linearity and additivity<a class="anchor" aria-label="anchor" href="#linearity-and-additivity"></a>
</h3>
<p>This assumption states that our outcome variable has a linear,
additive relationship with the explanatory variables.</p>
<p>The <em>linearity</em> component means that our outcome variable is
described by a linear function of the explanatory variable(s). On a
practical level, this means that the line produced by our model should
match the shape of the data. We learned to check that the relationship
between our two variables is linear through the exploratory plots. For
an example where the linearity assumption is violated, see the plot
below. The relationship between <code>BPDiaAve</code> and
<code>AgeMonths</code> is non-linear and our model fails to capture this
non-linear relationship.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPDiaAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPDiaAve</span> <span class="op">~</span> <span class="va">AgeMonths</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">BPDiaAve_AgeMonths_lm</span>, pred <span class="op">=</span> <span class="va">AgeMonths</span>, </span>
<span>            plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Combined diastolic blood pressure"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age in Months"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-non-linearity%20example%20part%201-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Adding a squared term to our model, designated by
<code>I(AgeMonths^2)</code>, allows our model to capture the non-linear
relationship, as the following plot shows. Thus, the model with formula
<code>BPDiaAve ~ AgeMonths + I(AgeMonths^2)</code> does not appear to
violate the linearity assumption.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPDiaAve_AgeMonthsSQ_lm</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPDiaAve</span> <span class="op">~</span> <span class="va">AgeMonths</span> <span class="op">+</span> <span class="fu">I</span><span class="op">(</span><span class="va">AgeMonths</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">BPDiaAve_AgeMonthsSQ_lm</span>, pred <span class="op">=</span> <span class="va">AgeMonths</span>, </span>
<span>            plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Combined diastolic blood pressure"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age in Months"</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-non-linearity%20example%20part%202-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>In the example above we saw that squaring an explanatory variable can
correct for curvature seen in the outcome variable along the explanatory
variable.</p>
<p>In the following example, we will see that taking the log
transformation of the dependent variable can also sometimes be an
effective solution to non-linearity.</p>
<p>Earlier in this lesson we worked with <code>Weight</code> and
<code>Height</code> in adults. Here, we will work with these variables
in children. Firstly, fit a linear regression model of Weight
(<code>Weight</code>) as a function of Height (<code>Height</code>) in
children (participants below the Age (<code>Age</code>) of 18). Then,
create an effect plot using <code>effect_plot()</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">child_Weight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">18</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">child_Weight_Height_lm</span>, pred <span class="op">=</span> <span class="va">Height</span>, </span>
<span>                  plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-non-linearity%20challenge%20part%201-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="challenge5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em><a class="anchor" aria-label="anchor" href="#challenge5"></a>
</h3>
<div class="callout-content">
<p>There is curvature in the data, which makes a straight line
unsuitable.</p>
<p>We will explore the log transformation as a potential solution. Fit a
linear regression model as before, however change <code>Weight</code> in
the <code>lm()</code> command to <code>log(Weight)</code>. Then create
an <code>effect_plot</code>. Is the relationship between
<code>log(Weight)</code> and <code>Height</code> different from the
relationship between <code>Weight</code> and <code>Height</code> in
children?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">child_logWeight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">18</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu">log</span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">child_logWeight_Height_lm</span>, pred <span class="op">=</span> <span class="va">Height</span>, </span>
<span>                  plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-non-linearity%20challenge%20part%202-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The non-linear relationship has now been transformed into a more
linear relationship by taking the log transformation of the response
variable.</p>
</div>
</div>
</div>
</div>
<p>The <em>additivity</em> component means that the effect of any
explanatory variable on the outcome variable does not depend on another
explanatory variable in the model. When this assumption is violated, it
can be mitigated by including an interaction term in the model. We will
cover interaction terms in the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health/" class="external-link">multiple
linear regression for public health lesson</a>.</p>
</div>
<div class="section level3">
<h3 id="independent-errors">4. Independent errors<a class="anchor" aria-label="anchor" href="#independent-errors"></a>
</h3>
<p>This assumption states that the residuals must be independent of one
another. This assumption is violated when observations are not a random
sample of the population, i.e. when observations are non-independent.
Two common types of non-independence, and their common solutions,
are:</p>
<ol style="list-style-type: upper-alpha">
<li>Observations in our data can be grouped. For example, participants
in a national health survey can be grouped by their region of residence.
Therefore, observations from individuals from the same region will be
non-independent. As a result, the residuals will also not be
independent.</li>
</ol>
<p><strong>Common solution:</strong> If there are a few levels in our
grouping variable (say, less than 6) then we might choose to include the
grouping variable as an explanatory variable in our model. If the
grouping variable has more levels, we may choose to include the variable
as a random effect, a component of mixed effect models (not discussed
here).</p>
<ol start="2" style="list-style-type: upper-alpha">
<li>Our data contains repeated measurements on the same individuals. For
example, we measure individual’s weights four times over the course of a
year. Here our data contains four non-independent observations per
individual. As a result, the residuals will also not be
independent.</li>
</ol>
<p><strong>Common solution:</strong> This can be overcome using random
effects, which are a component of mixed effects models (not discussed
here).</p>
<div id="challenge6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge6"></a>
</h3>
<div class="callout-content">
<p>In which of the following scenarios would the independent errors
assumption likely be violated?</p>
<ol style="list-style-type: upper-alpha">
<li>We are modeling the effect of a fitness program on people’s fitness
level. Our data consists of weekly fitness measurements on the same
group of individuals.<br>
</li>
<li>We are modeling the effect of dementia prevention treatments on life
expectancy, with each participant coming from one of five care homes.
Our data consists of: life expectancy, whether an individual was on a
dementia prevention treatment and the care home that the individual was
in.<br>
</li>
<li>We are modeling the effect of income on home size in a random sample
of the adult UK population.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<ol style="list-style-type: upper-alpha">
<li>Since we have multiple observations per participant, our
observations are not independent. We would hereby violate the
independent errors assumption.<br>
</li>
<li>Our observations are non-independent because multiple individuals
will have belonged to the same carehome. In this case, adding carehome
to our model would allow us to overcome the violation of the independent
errors assumption.<br>
</li>
<li>Since our data is a random sample, we are not violating the
independent errors assumption through non-independence in our data.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="equal-variance-of-errors-homoscedasticity">5. Equal variance of errors (homoscedasticity)<a class="anchor" aria-label="anchor" href="#equal-variance-of-errors-homoscedasticity"></a>
</h3>
<p>This assumption states that the magnitude of variation in the
residuals is not different across the expected values or any explanatory
variable. In the context of this assumption, the expected values are
referred to as the “fitted values” (i.e. the expected values obtained by
fitting the model). Violation of this assumption can result in
unreliable estimates of the standard errors of coefficients, which may
impact statistical inference. Predictions from the model may become
unreliable too. Transformation can sometimes be used to resolve
heteroscedasticity. In other cases, weighted least squares can be used
(not discussed in this lesson).</p>
<p>For example, we can study the relationship between the residuals and
the fitted values of our <code>Height_Weight_lm</code> model (the adult
model, fit in episode 2). We store the residuals, fitted values and
explanatory variable in a tibble named <code>residualData</code>. The
residuals are accessed using <code>resid()</code>, the fitted values are
accessed using <code>fitted()</code> and the explanatory variable
(<code>Height</code>) is accessed through the <code>Height</code> column
of <code>Weight_Height_lm$model</code>.</p>
<p>We create a residuals vs. fitted plot named <code>p1</code> and a
residuals vs. explanatory variable plot named <code>p2</code>. In both
of these plots, we add a line that approximately tracks the mean of the
residuals across the fitted values and explanatory variable using
<code>geom_smooth()</code>. The two plots are brought together into one
plotting region using <code>p1 + p2</code>, where the <code>+</code>
relies on the <code>patchwork</code> package being loaded.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="va">residualData</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">Weight_Height_lm</span><span class="op">)</span>,</span>
<span>                    fitted <span class="op">=</span> <span class="fu">fitted</span><span class="op">(</span><span class="va">Weight_Height_lm</span><span class="op">)</span>,</span>
<span>                    height <span class="op">=</span> <span class="va">Weight_Height_lm</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">fitted</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residual"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Height"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-heteroscedasticity%20example-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Since there is no obvious pattern in the residuals along the fitted
values or the explanatory variable, there is no reason to suspect that
the equal variance assumption has been violated.</p>
<div id="challenge7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-5" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge7"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create diagnistic plots to check for heteroscedasticity in our
<code>BPSysAve_AgeMonths_lm</code> model.</li>
<li>Do you believe the equal variance assumption has been violated?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPSysAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPSysAve</span> <span class="op">~</span> <span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="va">residualData</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span><span class="op">)</span>,</span>
<span>                    fitted <span class="op">=</span> <span class="fu">fitted</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span><span class="op">)</span>,</span>
<span>                    agemonths <span class="op">=</span> <span class="va">BPSysAve_AgeMonths_lm</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">fitted</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">agemonths</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age in Months"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-heteroscedasticity%20challenge-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The variation in the residuals does somewhat increase with an
increase in fitted values and an increase in <code>AgeMonths</code>.
Therefore, this model may violate the homoscedasticity assumption.
Because the majority of residuals still lie in the central band, we may
not worry about this violation much. However, if we wanted to resolve
the increase in residuals, we may choose to add more variables to our
model or to apply a Box-Cox transformation on <code>BPSysAve</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="normality-of-errors">6. Normality of errors<a class="anchor" aria-label="anchor" href="#normality-of-errors"></a>
</h3>
<p>This assumption states that the errors follow a Normal distribution.
When this assumption is strongly violated, predictions of individual
data points from the model are less reliable. Small deviations from
normality may pose less of an issue. One way to check this assumption is
to plot a histogram of the residuals and to ask whether it looks
strongly non-normal (e.g. bimodal or uniform).</p>
<p>For example, looking at a histogram of the residuals of our
<code>Height_Weight_lm</code> model reveals a distribution that is
slightly skewed. Since this is not a strong deviation from normality, we
do not have to worry about violating the assumption.</p>
<p>Note that if a model includes a grouping variable (e.g. a two-level
categorical variable), the normality of the residuals is to be checked
separately for each group. Also note that in the previous episode, we
only covered prediction of the mean, not of individual data points. A
deviation of the residuals from normality is usually not a concern for
predictions of the mean.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">Weight_Height_lm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">residuals</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Residual"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-check%20normality%20example-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge8" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-6" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge8"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Construct a histogram of the residuals of the
<code>TotChol_SmokeNow_lm</code> model.</li>
<li>Does the distribution suggest that the normality assumption is
violated?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TotChol_SmokeNow_lm</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">TotChol</span> <span class="op">~</span> <span class="va">SmokeNow</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">TotChol_SmokeNow_lm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">residuals</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Residual"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/05-fitAndAssumptionSLR-rendered-check%20normality%20challenge-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Since the distribution is only slightly skewed, we do not have to
worry about violating the normality assumption.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Assessing model fit is the process of visually checking whether the
model fits the data sufficiently well.</li>
<li>
<span class="math inline">\(R^2\)</span> quantifies the proportion
of variation in the response variable explained by the explanatory
variable. An <span class="math inline">\(R^2\)</span> close to 1
indicates that most variation is accounted for by the model, while an
<span class="math inline">\(R^2\)</span> close to 0 indicates that the
model does not perform much better than predicting the mean of the
response.</li>
<li>The six assumptions of the simple linear regression model are
validity, representativeness, linearity and additivity, independence of
errors, homoscedasticity of the residuals and normality of the
residuals.</li>
<li>We can check the assumptions of a simple linear regression model by
carefully considering our research question, the data set that we are
using and by visualising our model parameters.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-06-multiLvlFactor"><p>Content from <a href="06-multiLvlFactor.html">Optional: linear regression with a multi-level factor explanatory variable</a></p>
<hr>
<p> Last updated on 2023-01-31 | 
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/06-multiLvlFactor.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we explore the relationship between one continuous variable
and one multi-level categorical variable prior to fitting a simple
linear regression?</li>
<li>How can we fit a simple linear regression model with one multi-level
categorical explanatory variable in R?</li>
<li>How can the parameters of this model be interpreted in R?</li>
<li>How can this model be visualised in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use the ggplot2 package to explore the relationship between a
continuous variable and a factor variable with more than two
levels.</li>
<li>Use the lm command to fit a simple linear regression with a factor
explanatory variable with more than two levels.</li>
<li>Use the jtools package to interpret the model output.</li>
<li>Use the jtools and ggplot2 packages to visualise the resulting
model.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In this episode we will study linear regression with one categorical
variable with more than two levels. We can explore the relationship
between two variables ahead of fitting a model using the
<code>ggplot2</code> package.</p>
<section id="exploring-the-relationship-between-a-continuous-variable-and-a-multi-level-categorical-variable"><h2 class="section-heading">Exploring the relationship between a continuous variable and a
multi-level categorical variable<a class="anchor" aria-label="anchor" href="#exploring-the-relationship-between-a-continuous-variable-and-a-multi-level-categorical-variable"></a>
</h2>
<hr class="half-width">
<p>Let us take <code>Work</code> and <code>Age</code> as an example.
<code>Work</code> describes whether someone is looking for work, not
working or working. In the code below, we first subset our data for
working age individuals using <code>filter()</code> and
<code>between()</code>. We then initiate a plotting object using
<code>ggplot()</code>, with the data passed on to the plot command by
the pipe. We select the variables of interest inside <code>aes()</code>.
We then create a violin plot using <code>geom_violin</code>. The shapes
of the objects are representative of the distributions of
<code>Age</code> in the three groups. We overlay the means and their 95%
confidence intervals using <code>stat_summary()</code>. Finally, we
change the axis labels using <code>xlab()</code> and <code>ylab()</code>
and the x-axis ticks using <code>scale_x_discrete()</code>. This latter
step ensures that the <code>NotWorking</code> data is labelled as
<code>Not Working</code>, i.e. with a space.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">Age</span>, <span class="fl">16</span>, <span class="fl">64</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Work</span>, y <span class="op">=</span> <span class="va">Age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_cl_normal"</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Working status"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'Looking'</span>,<span class="st">'Not Working'</span>,<span class="st">'Working'</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/06-multiLvlFactor-rendered-explore%20Work%20vs%20Age-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>You have been asked to model the relationship between the frequency
of days where individuals feel depressed and weight in the NHANES data.
Use the ggplot2 package to create an exploratory plot, with NAs dropped
from <code>Depressed</code>, ensuring the plot includes the following
elements:</p>
<ol style="list-style-type: decimal">
<li>Weight (<code>Weight</code>) on the y-axis and number of days with
depressed feelings (<code>Depressed</code>) on the x-axis, from the
NHANES data.</li>
<li>These data presented using a violin plot.</li>
<li>The y-axis labelled as “Age (years)” and the x-axis labelled as
“Number of days a week with depressed feelings”.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">Depressed</span>, <span class="va">Weight</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Depressed</span>, y <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_cl_normal"</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Number of days a week with depressed feelings"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Weight"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/06-multiLvlFactor-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="fitting-and-interpreting-a-simple-linear-regression-model-with-one-multi-level-categorical-variable"><h2 class="section-heading">Fitting and interpreting a simple linear regression model with one
multi-level categorical variable<a class="anchor" aria-label="anchor" href="#fitting-and-interpreting-a-simple-linear-regression-model-with-one-multi-level-categorical-variable"></a>
</h2>
<hr class="half-width">
<p>We proceed to fit a linear regression model using the
<code>lm()</code> command, as we did in the previous episode. The model
is then interpreted using <code>summ()</code>. The intercept in the
<code>summ()</code> output is the estimated mean for the baseline,
i.e. for participants that are looking for work. The
<code>WorkNotWorking</code> estimate is the estimated average difference
in <code>Age</code> between participants that are not working and are
looking for work. Similarly, the <code>WorkWorking</code> is the
estimated average difference in <code>Age</code> between participants
that are working and are looking for work.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Age_Work_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">Age</span>, <span class="fl">16</span>, <span class="fl">64</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Age</span> <span class="op">~</span> <span class="va">Work</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">Age_Work_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 5149
Dependent Variable: Age
Type: OLS linear regression 

MODEL FIT:
F(2,5146) = 21.267, p = 0.000
R² = 0.008
Adj. R² = 0.008 

Standard errors: OLS
----------------------------------------------------------------
                         Est.     2.5%    97.5%   t val.       p
-------------------- -------- -------- -------- -------- -------
(Intercept)            34.208   32.519   35.897   39.702   0.000
WorkNotWorking          4.398    2.577    6.218    4.735   0.000
WorkWorking             5.620    3.859    7.380    6.258   0.000
----------------------------------------------------------------</code></pre>
</div>
<p>The model can therefore be written as:</p>
<p><span class="math display">\[E(Age) = 34.208 + 4.398 \\times x\_1 +
5.620 \\times x\_2,\]</span></p>
<p>where <span class="math inline">\(x_1 = 1\)</span> if an individual
is not working and <span class="math inline">\(x_1 = 0\)</span>
otherwise. Similarly, <span class="math inline">\(x_2 = 1\)</span> if an
individual is working and <span class="math inline">\(x_2 = 0\)</span>
otherwise.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Using the <code>lm()</code> command, fit a simple linear regression
of Weight as a function of number of days a week feeling depressed
(<code>Depressed</code>). Ensure that NAs are dropped from
<code>Depressed</code>. Name this <code>lm</code> object
<code>Weight_Depressed_lm</code>.</li>
<li>Using the <code>summ()</code> function from the <code>jtools</code>
package, answer the following questions:</li>
</ol>
<ol style="list-style-type: upper-alpha">
<li>What average weight does the model predict, on average, for an
individual who is not experiencing depressed days?<br>
</li>
<li>By how much is weight expected to change, on average, for each other
level of <code>Depressed</code>?<br>
</li>
<li>Given these two values and the names of the response and explanatory
variables, how can the general equation <span class="math inline">\(E(y)
= \beta_0 + {\beta}_1 \times x_1 + {\beta}_2 \times x_2\)</span> be
adapted to represent this model?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weight_Depressed_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">Depressed</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Depressed</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">Weight_Depressed_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 5512 (61 missing obs. deleted)
Dependent Variable: Weight
Type: OLS linear regression 

MODEL FIT:
F(2,5509) = 3.737, p = 0.024
R² = 0.001
Adj. R² = 0.001 

Standard errors: OLS
-------------------------------------------------------------------
                           Est.     2.5%    97.5%    t val.       p
---------------------- -------- -------- -------- --------- -------
(Intercept)              81.369   80.734   82.005   251.044   0.000
DepressedSeveral          1.263   -0.262    2.789     1.623   0.105
DepressedMost             2.647    0.467    4.826     2.381   0.017
-------------------------------------------------------------------</code></pre>
</div>
<ol style="list-style-type: upper-alpha">
<li>81.37<br>
</li>
<li>Increase by 1.26 and 2.65 for several depressed days and most
depressed days, respectively.<br>
</li>
<li>
<span class="math inline">\(E(\text{Weight}) = 81.37 + 1.26 \times
x_1 + 2.65 \times x_2\)</span>, where <span class="math inline">\(x_1 =
1\)</span> if an individual is depressed several days a week and <span class="math inline">\(x_1 = 0\)</span> otherwise. Analogously, <span class="math inline">\(x_2 = 1\)</span> if an individual is depressed
most days a week and <span class="math inline">\(x_2 = 0\)</span>
otherwise.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="visualising-a-simple-linear-regression-model-with-one-multi-level-categorical-variable"><h2 class="section-heading">Visualising a simple linear regression model with one multi-level
categorical variable<a class="anchor" aria-label="anchor" href="#visualising-a-simple-linear-regression-model-with-one-multi-level-categorical-variable"></a>
</h2>
<hr class="half-width">
<p>Finally, we visually inspect the parameter estimates provided by our
model. Again we can use <code>effect_plot()</code> from the
<code>jtools</code> package. We include <code>jitter = c(0.3, 0)</code>
and <code>point.alpha = 0.2</code> so that points are spread out
horizontally and so that multiple overlayed points create a darker
colour, respectively. The plot shows the mean age estimates for each
level of <code>Work</code>, with their 95% confidence intervals. This
allows us to see how different the means are predicted to be and within
what range we can expect the true population means to fall.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">Age_Work_lm</span>, pred <span class="op">=</span> <span class="va">Work</span>,</span>
<span>            plot.points <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span>, point.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Working status"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">'Looking'</span>,<span class="st">'Not Working'</span>,<span class="st">'Working'</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/06-multiLvlFactor-rendered-effect_plot%20age%20vs%20work-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Use the <code>jtools</code> package to visualise the model of
<code>Weight</code> as a function of <code>Depressed</code>.</li>
<li>Ensure that the x-axis is labelled as “Number of days feeling
depressed” and the y-axis is labelled as “Weight”.</li>
<li>How does this plot relate to the output given by
<code>summ</code>?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">Weight_Depressed_lm</span>, pred <span class="op">=</span> <span class="va">Depressed</span>, </span>
<span>plot.points <span class="op">=</span> <span class="cn">TRUE</span>, jitter <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span>, point.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Number of days feeling depressed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Weight (kg)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/06-multiLvlFactor-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This plot shows the mean estimates for <code>Weight</code> for the
three groups, alongside their 95% confidence intervals. The mean
estimates are represented by the <code>Intercept</code> for the
non-depressed group and by <code>Intercept</code> +
<code>DepressedSeveral</code> and <code>Intercept</code> +
<code>DepressedMost</code> for the other groups.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>As a first exploration of the data, construct a violin plot to
describe the relationship between the two variables.</li>
<li>Use <code>lm()</code> to fit the simple linear regression
model.</li>
<li>Use <code>summ()</code> to obtain parameter estimates for the
model.</li>
<li>The intercept estimates the mean in the outcome variable for the
baseline group. The other parameters estimate the differences in the
means in the outcome variable between the baseline and contrast
groups.</li>
<li>Use <code>effect_plot()</code> to visualise the estimated means per
group along with their 95% CIs.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/" class="external-link">Source</a></p>
				<p><a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:elh605@york.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.11.6" class="external-link">sandpaper (0.11.6)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.4.3" class="external-link">pegboard (0.4.3)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.14" class="external-link">varnish (0.2.14)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://preview.carpentries.org/simple-linear-regression-public-health/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://preview.carpentries.org/simple-linear-regression-public-health/aio.html",
  "identifier": "https://preview.carpentries.org/simple-linear-regression-public-health/aio.html",
  "dateCreated": "2022-11-15",
  "dateModified": "2023-02-21",
  "datePublished": "2023-02-21"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

