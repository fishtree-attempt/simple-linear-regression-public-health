---
title: "Linear regression with a two-level factor explanatory variable"
source: Rmd
objectives:
- Use the ggplot2 package to explore the relationship between a continuous variable
  and a two-level factor variable.
- Use the lm command to fit a simple linear regression with a two-level factor explanatory
  variable.
- Use the jtools package to interpret the model output.
- Use the jtools and ggplot2 packages to visualise the resulting model.
keypoints: DEF
questions: GHI
teaching: 10
execises: 10
---

```{r, include=FALSE}
source("../bin/chunk-options.R")
source("../bin/obtain_data.R")
knitr_fig_path("03-")
library(ggplot2)
library(dplyr)
library(tidyr)
library(jtools)
```

```{r explore physical activity vs pulse}
dat %>%
  drop_na(c("PhysActive", "Pulse")) %>%
  ggplot(., aes(x=PhysActive, y=Pulse)) +
  geom_violin() +
  stat_summary(fun = "mean", size = 0.2) +
  stat_summary(fun.data = "mean_cl_normal", geom="errorbar", width=0.2) +
  xlab("Physically Active")
```

> ## Exercise  
> You have been asked to model the relationship between pulse
> and physical activity in the NHANES data. Use the ggplot2 package  
> to create an exploratory plot, ensuring that it includes the following elements:  
> 1. Pulse (`Pulse`) on the y-axis and physical activity (`PhysActive`) on the
> x-axis, from the NHANES data.  
> 2. This data shown as a violin plot.  
> 3. The y-axis labelled as "Pulse" and the x-axis labelled
> as "Physically Active".  
{: .challenge}

```{r PhysActive vs Pulse model}
Pulse_PhysActive_lm <- lm(Pulse ~ PhysActive, data = dat)

summ(Pulse_PhysActive_lm, confint = TRUE, digits=3)
```

> ## Exercise  
> 1. Using the `lm()` command, fit a simple linear regression of pulse (`Pulse`)  
> as a function of physical activity (`PhysActive`). Name this `lm` 
> object `Pulse_PhysActive_lm`.  
> 2. Using the `summary()` function, answer the following questions:
>   
> A) What pulse does the model predict, on average,
> for an individual who is characterised as not physically active?  
> B) By how much is pulse expected to change, on average, for
> a physically active individual?  
> C) Given these two values and the names of the response and explanatory
> variables, how can the general equation $E(y) = \beta_0 + {\beta}_1 
> \times x$ be adapted to represent this model?  
{: .challenge}

```{r plot pulse vs physactive with model}
effect_plot(Pulse_PhysActive_lm, pred = PhysActive) +
  xlab("Physically Active")
```

> ## Exercise  
> Use the `jtools` package to visualise the model of `Pulse` as a function of `PhysActive`.  
> Ensure that the x-axis is labelled as "Physically active" rather than "PhysActive".  
> How does this plot relate to the output given by `summ`?  
{: .challenge}


