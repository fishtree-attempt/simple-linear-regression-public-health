---
title: "Linear regression with one continuous explanatory variable"
source: Rmd
objectives:
- Use the ggplot2 package to explore the relationship between two continuous variables.
- Use the lm command to fit a simple linear regression with one continuous explanatory
  variable.
- Use the jtools package to interpret the model output.
- Use the jtools and ggplot2 packages to visualise the resulting model.
keypoints: DEF
questions: GHI
teaching: 10
execises: 10
---

```{r, include=FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("02-")
```

```{r load data, include=FALSE}
library(ggplot2)
library(jtools)
library(NHANES)
dat <- NHANES
```

> ## Exercise  
> You have been asked to model the relationship between Total Cholesterol
> and BMI in the NHANES data. In order to fit a simple linear regression 
> model, you first need to confirm that the relationship between these
> variables appears linear. Use the ggplot2 package to create a plot,
> ensuring that it includes the following elements:  
> 1. Total cholesterol (`TotChol`) on the y-axis and BMI (`BMI`) on the
> x-axis, from the NHANES data.  
> 2. This data shown as a scatterplot.  
> 3. The y-axis labelled as "Total Cholesterol" and the x-axis labelled
> as "BMI".  
{: .challenge}

```{r TotChol vs BMI model}
TotChol_BMI_lm <- lm(TotChol ~ BMI, data = dat)

summ(TotChol_BMI_lm, confint = TRUE, digits=3)
```


> ## Exercise  
> Now that you have confirmed that the relationship between Total Cholesterol
> and BMI appears linear in the NHANES data, you can proceed to fitting
> a simple linear regression model.  
>   
> 1. Using the `lm()` command, fit a simple linear regression of Total
> Cholesterol (`TotChol`) as a function of BMI (`BMI`). Name this `lm` 
> object `TotChol_BMI_lm`.  
> 2. Using the `summ` function from the `jtools` package, answer the following questions:
>   
> A) What level of Total Cholesterol does the model predict, on average,
> for an individual with a BMI of 0?  
> B) By how much is Total Cholesterol expected to increase, on average, for
> a one-unit increase in BMI?  
> C) Given these two values and the names of the response and explanatory
> variables, how can the general equation $E(y) = \beta_0 + {\beta}_1 
> \times x$ be adapted to represent your model?  
{: .challenge}


```{r plot totchol vs BMI}
effect_plot(TotChol_BMI_lm, pred = BMI, plot.points = TRUE, interval = TRUE) +
  ylab("Total Cholesterol")
```

> ## Exercise  
> You have been asked to report on your simple linear regression model at 
> the next lab meeting. To help your colleagues interpret the model, you
> decide to produce a figure. Make this figure using the jtools package.
> Ensure that the y-axis is labelled as "Total Cholesterol" rather than "TotChol".  
{: .challenge}

