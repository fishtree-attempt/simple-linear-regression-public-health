---
source: Rmd
title: "Making predictions from a simple linear regression model"
objectives:
  - "Calculate a prediction from a simple linear regression model using parameter estimates given by the model output."
  - "Use the predict function to generate predictions from a simple linear regression model."
keypoints:
- Predictions of the mean in the outcome variable can be manually calculated using the model's equation.
- Predictions of multiple means in the outcome variable alongside 95% CIs can be obtained using the `predict()` function. 
questions:
  - How can predictions be manually obtained from a simple linear regression model?
  - How can R be used to obtain predictions from a simple linear regression model?
teaching: 10
execises: 10
---

```{r, include=FALSE}
source("../bin/chunk-options.R")
source("../bin/obtain_data.R")
knitr_fig_path("05-")
library(ggplot2)
library(dplyr)
library(jtools)
```

One of the features of linear regression is prediction: a model presents predicted mean values for the outcome variable for any values of the explanatory variables. We have already seen this in the previous episodes through our `effect_plot()` outputs, which showed mean predicted responses as straight lines (episode 2) or individual points for levels of a categorical variable (episodes 3 & 4). Here, we will see how to obtain predicted values and the uncertainty surrounding them.

First, we can calculate a predicted value manually. From the `summ()` output associated with our `Weight_Height_lm` model from episode 2, we can write the model as $E(\text{Weight}_i) = \beta_0 + \beta_1 \times \text{Height}_i = -70.194 + 0.901 \times \text{Height}_i$. The output can be found again below. If we take a height of 165 cm, then our model predicts an average weight of $-70.194 + 0.901 \times 165 = 78.471$ kg. 

```{r weight vs height model}
Weight_Height_lm <- dat %>%
  filter(Age > 17) %>%
  lm(formula = Weight ~ Height)

summ(Weight_Height_lm)
```

>## Exercise
>Given the `summ` output from our `UrineFlow_UrineVol_lm` model, 
>the model can be described
>as $E(\text{UrineFlow}_i) = \beta_0 + \beta_1 \times \text{UrineVol}_i = 0.222 + 0.006 \times \text{UrineVol}_i$. 
>What level of Urine Flow does the model predict, on average, 
>for an individual with a Urine Volume of 100 mL?
> > ## Solution
> > $0.222 + 100 * 0.006 = 0.822 mL/min$.
> {: .solution}
{: .challenge}

Using the `predict()` function brings two advantages. First, when calculating multiple predictions, we are saved the effort of inserting multiple values into our model manually and doing the calculations. Secondly, `predict()` returns 95% confidence intervals around the predictions, giving us a sense of the uncertainty around the predictions. 

To use `predict()`, we need to create a `data.frame` with the explanatory variable values for which we wish to have mean predictions from the model. We do this using the `data.frame()` function. Note that the column name must correspond to the name of the explanatory variable in the model, i.e. `Height`. In the code below, we create a `data.frame` with the values 150, 160, 170 and 180. We then provide `predict` with this `data.frame`, alongside the model from which we wish to have predictions and `interval = "confidence"` to obtain 95% confidence intervals. 

We see that the model predicts and average weight of 64.88 kg for an individual with a height of 150 cm, with a 95% confidence interval of [63.90, 65.87]. 

```{r Weight_Height_lm predict}
Heights <- tibble(Height = c(150, 160, 170, 180))

predict(Weight_Height_lm, newdata = test, interval = "confidence")
```


>## Exercise
>Using the `predict` function, obtain the expected mean Urine Flow levels
>predicted by the `UrineFlow_UrineVol_lm` model for individuals with a Urine Volume
> of 50, 100, 150 and 200 mL. Obtain confidence intervals for these predictions. 
How are these confidence intervals interpreted?
> > ## Solution
> > ```{r}
> > UrineFlow_UrineVol_lm <- lm(formula = UrineFlow1 ~ UrineVol1, data = dat)
> > 
> > UrineVolumes <- data.frame(UrineVol1 = c(50, 100, 150, 200))
> > 
> > predict(UrineFlow_UrineVol_lm, newdata = UrineVolumes, interval = "confidence")
> > ```
> > Recall that 95% of 95% confidence intervals are expected to contain the 
> > population mean. 
> > Therefore, we can be fairly confident that the true population means lie 
> > somewhere between the bounds of the intervals, assuming that our model is good.
> {: .solution}
{: .challenge}

