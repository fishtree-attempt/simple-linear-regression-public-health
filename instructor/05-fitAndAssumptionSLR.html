<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Simple linear regression for public health: Assessing simple linear regression model fit and assumptions</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team." style="text-decoration: unset">
          Â 
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link" style="color: #383838">Beta
            <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #001483; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container ">
      
      <div class="beta-alert alert alert-light alert-dismissable fade show" role="alert">
        
        
        
        <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #5bbad5"></i>
        
        Workbench Beta | 
        <a href="https://carpentries.typeform.com/to/KRBl4IZM" class="external-link alert-link" style="text-decoration: wavy overline">Give Feedback</a> | 
        <a href="https://carpentries.github.io/workbench/beta-phase.html" class="external-link alert-link">Learn More</a>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../05-fitAndAssumptionSLR.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Simple linear regression for public health
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Simple linear regression for public health
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Simple linear regression for public health
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 45%" class="percentage">
    45%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 45%" aria-valuenow="45" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../05-fitAndAssumptionSLR.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introSLR.html">1. An introduction to linear regression</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-singleContPred.html">2. Linear regression with one continuous explanatory variable</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-twoLvlFactor.html">3. Linear regression with a two-level factor explanatory variable</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-predictionSLR.html">4. Making predictions from a simple linear regression model</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Assessing simple linear regression model fit and assumptions
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#using-residuals-to-assess-model-fit">Using residuals to assess model fit</a></li>
<li><a href="#measuring-model-fit-using-r2">Measuring model fit using <span class="math inline">\(R^2\)</span></a></li>
<li><a href="#assessing-the-assumptions-of-simple-linear-regression">Assessing the assumptions of simple linear regression</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-multiLvlFactor.html">6. Optional: linear regression with a multi-level factor explanatory variable</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/04-predictionSLR.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-multiLvlFactor.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/04-predictionSLR.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous: Making predictions</a>
        <a class="chapter-link float-end" href="../instructor/06-multiLvlFactor.html" rel="next">Next: Optional: linear... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Assessing simple linear regression model fit and assumptions</h1>
        <p> Last updated on 2023-07-11 | 
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/05-fitAndAssumptionSLR.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 120 minutes </p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What does it mean to assess model fit?</li>
<li>What does <span class="math inline">\(R^2\)</span> quantify and how
is it interpreted?</li>
<li>What are the six assumptions of simple linear regression?</li>
<li>How do I check if any of these assumptions are violated?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain what is meant by model fit.</li>
<li>Use the <span class="math inline">\(R^2\)</span> value as a measure
of model fit.</li>
<li>Describe the assumptions of the simple linear regression model.</li>
<li>Assess whether the assumptions of the simple linear regression model
have been violated.</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>In this episode we will learn what is meant by model fit, how to
interpret the <span class="math inline">\(R^2\)</span> measure of model
fit and how to assess whether our model meets the assumptions of simple
linear regression. This episode was inspired by chapter 11 of the book
Regression and Other Stories (see <a href="https://users.aalto.fi/~ave/ROS.pdf" class="external-link">here</a> for a pdf copy).</p>
<section id="using-residuals-to-assess-model-fit"><h2 class="section-heading">Using residuals to assess model fit<a class="anchor" aria-label="anchor" href="#using-residuals-to-assess-model-fit"></a>
</h2>
<hr class="half-width"><p>Broadly speaking, when we assess model fit we are checking whether
our model fits the data sufficiently well. This process is somewhat
subjective, in that the majority of our assessments are performed
visually. While there are many ways to assess model fit, we will cover
two main components:</p>
<ol style="list-style-type: decimal"><li>Calculation of the variance in the response variable explained by
the model, <span class="math inline">\(R^2\)</span>.</li>
<li>Assessment of the assumptions of the simple linear regression
model.</li>
</ol><p>Both of these components rely on the use of <em>residuals</em>.
Recall that our model is characterized by a line, which predicts a value
for the outcome variable for each value of the explanatory variable. The
<em>difference</em> between an observed outcome and a predicted outcome
is a residual. Therefore, our model has as many residuals as the number
of observations used in fitting the model.</p>
<p>For a visual example of residuals, see the plot below. A simple
linear regression was fit to <code>Height</code> and <code>Weight</code>
data of participants with an <code>Age</code> of 25. To the right side,
we see a long red vertical line. This is a relatively large residual,
for an individual with a weight greater than predicted by the model. To
the left side, we see a shorter red vertical line. This is a relatively
small residual, for an individual with a weight close to that predicted
by the model.</p>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-residual%20example-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="measuring-model-fit-using-r2"><h2 class="section-heading">Measuring model fit using <span class="math inline">\(R^2\)</span><a class="anchor" aria-label="anchor" href="#measuring-model-fit-using-r2"></a>
</h2>
<hr class="half-width"><p>A commonly used summary statistic for model fit is <span class="math inline">\(R^2\)</span>, which quantifies the proportion of
variation in the outcome variable explained by the explanatory variable.
An <span class="math inline">\(R^2\)</span> close to 1 indicates that
the model accounts for most of the variation in the outcome variable. An
<span class="math inline">\(R^2\)</span> close to 0 indicates that most
of the variation in the outcome variable is not accounted for by the
model.</p>
<p>What does it mean when a model accounts for most of the variation in
the outcome variable? Or when it does not? Letâs look at examples of the
two extremes: <span class="math inline">\(R^2=1\)</span> and <span class="math inline">\(R^2=0\)</span>. In these cases, 100% and 0% of the
variation in the outcome variable is accounted for by the explanatory
variable, respectively.</p>
<p>Below is a plot of hypothetical data, with two regression lines. The
blue line goes perfectly through the data points, while the red line is
horizontal at the mean of the hypothetical data.</p>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-R%20squared%20extremes%20visualised-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>When a model accounts for all of the variation in the outcome
variable, the line goes perfectly through the data points. When a model
does not account for any of the variation in the outcome variable, the
model predicts the mean of the outcome variable, regardless of the
explanatory variable.</p>
<p>Usually our <span class="math inline">\(R^2\)</span> value will lie
somewhere between these two extremes. An <span class="math inline">\(R^2\)</span> close to 1 indicates that the data
does not scatter much around the model line. Therefore, our model
accounts for most of the variation in the outcome variable. An <span class="math inline">\(R^2\)</span> close to 0 indicates that our model
does not predict much better than the mean of the response variable.
Therefore, our model does not account for much of the variation in the
outcome variable. See for example plots below. The points in the left
plot lie closer to the line, so the model explains more of the variation
and the <span class="math inline">\(R^2\)</span> value is higher.</p>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-examples%20of%20R%20squared-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The cut-off for a âgoodâ <span class="math inline">\(R^2\)</span>
value varies by research question and data set. There are scenarios in
which explaining 10% of the variation in an outcome variable is âgoodâ,
while there are others where we may only be satisfied with much higher
<span class="math inline">\(R^2\)</span> values. The most important
thing is to not blindly rely on <span class="math inline">\(R^2\)</span>
as a measure of model fit. While it is a useful assessment, it needs to
be interpreted in the context of the research question and the
assumptions of the model used.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Find the R-squared value for the <code>summ</code> output of our
<code>BPSysAve_AgeMonths_lm</code> model from <a href="https://carpentries-incubator.github.io/simple-linear-regression-public-health/02-singleContPred" class="external-link">episode
2</a>.</li>
<li>What proportion of variation in average systolic blood pressure is
explained by age in our model?</li>
<li>Does our model account for most of the variation in
<code>BPSysAve</code>?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPSysAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPSysAve</span> <span class="op">~</span> <span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summ</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span>, confint <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>MODEL INFO:
Observations: 3084 (3413 missing obs. deleted)
Dependent Variable: BPSysAve
Type: OLS linear regression 

MODEL FIT:
F(1,3082) = 556.405, p = 0.000
RÂ² = 0.153
Adj. RÂ² = 0.153 

Standard errors: OLS
-----------------------------------------------------------------
                       Est.      2.5%     97.5%    t val.       p
----------------- --------- --------- --------- --------- -------
(Intercept)         101.812   100.166   103.458   121.276   0.000
AgeMonths             0.033     0.030     0.035    23.588   0.000
-----------------------------------------------------------------</code></pre>
</div>
<p>Since <span class="math inline">\(R^2 = 0.153\)</span>, our model
accounts for approximately 15% of the variation in
<code>BPSysAve</code>. Our model explains 15% of the variation on
<code>BPSysAve</code>, which a model that always predicts the mean would
not.</p>
</div>
</div>
</div>
</div>
</section><section id="assessing-the-assumptions-of-simple-linear-regression"><h2 class="section-heading">Assessing the assumptions of simple linear regression<a class="anchor" aria-label="anchor" href="#assessing-the-assumptions-of-simple-linear-regression"></a>
</h2>
<hr class="half-width"><p>Simple linear regression has six assumptions. We will discuss these
below and explore how to check that they are not violated through a
series of challenges with applied examples.</p>
<div class="section level3">
<h3 id="validity">1. Validity<a class="anchor" aria-label="anchor" href="#validity"></a></h3>
<p>The validity assumption states that the model is appropriate for the
research question. This may sound obvious, but it is easy to come to
unreliable conclusions because of inappropriate model choice. Validity
is assessed in three ways:</p>
<ol style="list-style-type: upper-alpha"><li>Does the outcome variable reflect the <em>phenomenon of
interest</em>? For example, it would not be appropriate to take our
<code>Pulse</code> vs <code>PhysActive</code> model as representative of
the effect of physical activity on general health.<br></li>
<li>Does the model include <em>all relevant explanatory variables</em>?
For example, we might decide that our model of <code>TotChol</code> vs
<code>BMI</code> requires inclusion of the <code>SmokeNow</code>
variable. While not discussed in this lesson, inclusion of more than one
explanatory variable is covered in the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health/" class="external-link">multiple
linear regression for public health</a> lesson.<br></li>
<li>Does the model generalise to our <em>case of interest</em>? For
example, it would not be appropriate to use our <code>Pulse</code> vs
<code>PhysActive</code> model, which was constructed using people of all
ages, if we were specifically interested in the effect of physical
activity on pulse rate in those aged 70+. A subsample of the NHANES data
may allow us to answer the research question.</li>
</ol><div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>You are asked to model the effect of age on general health of
South-Americans. A colleague proposes that you fit a simple linear
regression to the NHANES data, using <code>BMI</code> as the outcome
variable and <code>Age</code> as the explanatory variable. Using the
three points above, assess the validity of this model for the research
question.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">

</div>
</div>
</div>
</div>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em><a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: upper-alpha"><li>There is more to general health than <code>BMI</code> alone. In this
case, we may wish to use a different outcome variable. Alternatively, we
could make the research question more specific by specifying that we are
studying the effect of <code>Age</code> on <code>BMI</code> rather than
general health.<br></li>
<li>Since we are specifically asked to study the effect of
<code>Age</code> on general health, we may conclude that no further
explanatory variables are relevant to the research question. However,
there may still be explanatory variables that are important to include,
such as income or sex, if the effect of <code>Age</code> on general
health depends on other explanatory variables. This will be covered in
the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health/" class="external-link">next
lesson</a>.<br></li>
<li>Since the NHANES data was collected from individuals in the US, this
data may not be suitable for a research question relating to individuals
in South-America.</li>
</ol></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="representativeness">2. Representativeness<a class="anchor" aria-label="anchor" href="#representativeness"></a></h3>
<p>The representativeness assumption states that the <em>sample</em> is
representative of the <em>population</em> to which we are generalising
our findings. For example, if we were studying the relationship between
physical activity and pulse rate in US adults using the NHANES data, we
could assume that our sample is representative of our population of
interest. However, if we were to use data from a survey of care homes,
our data would not be representative of our population of interest: we
would have an overrepresentation of older people, compared to the US
adult population.</p>
<p>In combination with the <em>case of interest</em> criterium of the
<em>validity</em> assumption, we therefore ask:</p>
<ol style="list-style-type: decimal"><li>Are the individuals on which our data was collected a subset of the
population of individuals which we are interested in studying? This is a
component of validity.</li>
<li>Is our sample of individuals representative of the population of
interest in terms of the number of individuals in relevant categories,
e.g.Â ages? This is representativeness.</li>
</ol><p>Note that when the representativeness assumption is violated, this
can be solved by including the misrepresented feature as an explanatory
variable in the model. For example, if the sample and the population
have different age distributions, age can be included as a variable in
the model. Linear regression with multiple explanatory variables is
covered in the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health" class="external-link">multiple
linear regression lesson</a>.</p>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>One of your colleagues is asked to model the effect of income on
dissertation grade in final year undergraduate students. They decide to
survey 500 students at your university, asking them for their income and
recording their grade upon completion of the thesis.</p>
<ol style="list-style-type: upper-alpha"><li>Would fitting a model of thesis grade as a function of income using
this data violate the case of interest criterium of the validity
assumption?</li>
</ol><p>After completing the survey, your colleague finds that the proportion
of participants identifying as female in the data is 70%. Presume it is
known that at your university, 55% of final year undergraduate students
identify as female.</p>
<ol start="2" style="list-style-type: upper-alpha"><li>Would fitting a model of thesis grade as a function of income using
this data violate the representativeness assumption?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: upper-alpha"><li>Since the sample appears to be a subset of the population of
interest, the case of interest criterium would not be violated.<br></li>
<li>Since the sample is not representative of the population of
interest, the representativeness assumption would be violated. Including
a variable for gender may solve the violation. See the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health" class="external-link">multiple
linear regression lesson</a> for details on how to include multiple
variables in linear regression.</li>
</ol></div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="linearity-and-additivity">3. Linearity and additivity<a class="anchor" aria-label="anchor" href="#linearity-and-additivity"></a></h3>
<p>This assumption states that our outcome variable has a linear,
additive relationship with the explanatory variables.</p>
<p>The <em>linearity</em> component means that our outcome variable is
described by a linear function of the explanatory variable(s). On a
practical level, this means that the line produced by our model should
match the shape of the data. We learned to check that the relationship
between our two variables is linear through the exploratory plots. For
an example where the linearity assumption is violated, see the plot
below. The relationship between <code>BPDiaAve</code> and
<code>AgeMonths</code> is non-linear and our model fails to capture this
non-linear relationship.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPDiaAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPDiaAve</span> <span class="op">~</span> <span class="va">AgeMonths</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">BPDiaAve_AgeMonths_lm</span>, pred <span class="op">=</span> <span class="va">AgeMonths</span>, </span>
<span>            plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Combined diastolic blood pressure"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age in Months"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-non-linearity%20example%20part%201-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Adding a squared term to our model, designated by
<code>I(AgeMonths^2)</code>, allows our model to capture the non-linear
relationship, as the following plot shows. Thus, the model with formula
<code>BPDiaAve ~ AgeMonths + I(AgeMonths^2)</code> does not appear to
violate the linearity assumption.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPDiaAve_AgeMonthsSQ_lm</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPDiaAve</span> <span class="op">~</span> <span class="va">AgeMonths</span> <span class="op">+</span> <span class="fu">I</span><span class="op">(</span><span class="va">AgeMonths</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">BPDiaAve_AgeMonthsSQ_lm</span>, pred <span class="op">=</span> <span class="va">AgeMonths</span>, </span>
<span>            plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Combined diastolic blood pressure"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age in Months"</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-non-linearity%20example%20part%202-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h3>
<div class="callout-content">
<p>In the example above we saw that squaring an explanatory variable can
correct for curvature seen in the outcome variable along the explanatory
variable.</p>
<p>In the following example, we will see that taking the log
transformation of the dependent variable can also sometimes be an
effective solution to non-linearity.</p>
<p>Earlier in this lesson we worked with <code>Weight</code> and
<code>Height</code> in adults. Here, we will work with these variables
in children. Firstly, fit a linear regression model of Weight
(<code>Weight</code>) as a function of Height (<code>Height</code>) in
children (participants below the Age (<code>Age</code>) of 18). Then,
create an effect plot using <code>effect_plot()</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">child_Weight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">18</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">child_Weight_Height_lm</span>, pred <span class="op">=</span> <span class="va">Height</span>, </span>
<span>                  plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-non-linearity%20challenge%20part%201-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<div id="exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<em> (continued)</em><a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h3>
<div class="callout-content">
<p>There is curvature in the data, which makes a straight line
unsuitable.</p>
<p>We will explore the log transformation as a potential solution. Fit a
linear regression model as before, however change <code>Weight</code> in
the <code>lm()</code> command to <code>log(Weight)</code>. Then create
an <code>effect_plot</code>. Is the relationship between
<code>log(Weight)</code> and <code>Height</code> different from the
relationship between <code>Weight</code> and <code>Height</code> in
children?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">child_logWeight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">18</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu">log</span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effect_plot</span><span class="op">(</span><span class="va">child_logWeight_Height_lm</span>, pred <span class="op">=</span> <span class="va">Height</span>, </span>
<span>                  plot.points <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  line.colors <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-non-linearity%20challenge%20part%202-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The non-linear relationship has now been transformed into a more
linear relationship by taking the log transformation of the response
variable.</p>
</div>
</div>
</div>
</div>
<p>The <em>additivity</em> component means that the effect of any
explanatory variable on the outcome variable does not depend on another
explanatory variable in the model. When this assumption is violated, it
can be mitigated by including an interaction term in the model. We will
cover interaction terms in the <a href="https://carpentries-incubator.github.io/multiple-linear-regression-public-health/" class="external-link">multiple
linear regression for public health lesson</a>.</p>
</div>
<div class="section level3">
<h3 id="independent-errors">4. Independent errors<a class="anchor" aria-label="anchor" href="#independent-errors"></a></h3>
<p>This assumption states that the residuals must be independent of one
another. This assumption is violated when observations are not a random
sample of the population, i.e.Â when observations are non-independent.
Two common types of non-independence, and their common solutions,
are:</p>
<ol style="list-style-type: upper-alpha"><li>Observations in our data can be grouped. For example, participants
in a national health survey can be grouped by their region of residence.
Therefore, observations from individuals from the same region will be
non-independent. As a result, the residuals will also not be
independent.</li>
</ol><p><strong>Common solution:</strong> If there are a few levels in our
grouping variable (say, less than 6) then we might choose to include the
grouping variable as an explanatory variable in our model. If the
grouping variable has more levels, we may choose to include the variable
as a random effect, a component of mixed effect models (not discussed
here).</p>
<ol start="2" style="list-style-type: upper-alpha"><li>Our data contains repeated measurements on the same individuals. For
example, we measure individualâs weights four times over the course of a
year. Here our data contains four non-independent observations per
individual. As a result, the residuals will also not be
independent.</li>
</ol><p><strong>Common solution:</strong> This can be overcome using random
effects, which are a component of mixed effects models (not discussed
here).</p>
<div id="exercise-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-4"></a>
</h3>
<div class="callout-content">
<p>In which of the following scenarios would the independent errors
assumption likely be violated?</p>
<ol style="list-style-type: upper-alpha"><li>We are modeling the effect of a fitness program on peopleâs fitness
level. Our data consists of weekly fitness measurements on the same
group of individuals.<br></li>
<li>We are modeling the effect of dementia prevention treatments on life
expectancy, with each participant coming from one of five care homes.
Our data consists of: life expectancy, whether an individual was on a
dementia prevention treatment and the care home that the individual was
in.<br></li>
<li>We are modeling the effect of income on home size in a random sample
of the adult UK population.</li>
</ol></div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<ol style="list-style-type: upper-alpha"><li>Since we have multiple observations per participant, our
observations are not independent. We would hereby violate the
independent errors assumption.<br></li>
<li>Our observations are non-independent because multiple individuals
will have belonged to the same carehome. In this case, adding carehome
to our model would allow us to overcome the violation of the independent
errors assumption.<br></li>
<li>Since our data is a random sample, we are not violating the
independent errors assumption through non-independence in our data.</li>
</ol></div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="equal-variance-of-errors-homoscedasticity">5. Equal variance of errors (homoscedasticity)<a class="anchor" aria-label="anchor" href="#equal-variance-of-errors-homoscedasticity"></a></h3>
<p>This assumption states that the magnitude of variation in the
residuals is not different across the expected values or any explanatory
variable. In the context of this assumption, the expected values are
referred to as the âfitted valuesâ (i.e.Â the expected values obtained by
fitting the model). Violation of this assumption can result in
unreliable estimates of the standard errors of coefficients, which may
impact statistical inference. Predictions from the model may become
unreliable too. Transformation can sometimes be used to resolve
heteroscedasticity. In other cases, weighted least squares can be used
(not discussed in this lesson).</p>
<p>For example, we can study the relationship between the residuals and
the fitted values of our <code>Height_Weight_lm</code> model (the adult
model, fit in episode 2). We store the residuals, fitted values and
explanatory variable in a tibble named <code>residualData</code>. The
residuals are accessed using <code>resid()</code>, the fitted values are
accessed using <code>fitted()</code> and the explanatory variable
(<code>Height</code>) is accessed through the <code>Height</code> column
of <code>Weight_Height_lm$model</code>.</p>
<p>We create a residuals vs.Â fitted plot named <code>p1</code> and a
residuals vs.Â explanatory variable plot named <code>p2</code>. In both
of these plots, we add a line that approximately tracks the mean of the
residuals across the fitted values and explanatory variable using
<code>geom_smooth()</code>. The two plots are brought together into one
plotting region using <code>p1 + p2</code>, where the <code>+</code>
relies on the <code>patchwork</code> package being loaded.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Weight_Height_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Weight</span> <span class="op">~</span> <span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="va">residualData</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">Weight_Height_lm</span><span class="op">)</span>,</span>
<span>                    fitted <span class="op">=</span> <span class="fu">fitted</span><span class="op">(</span><span class="va">Weight_Height_lm</span><span class="op">)</span>,</span>
<span>                    height <span class="op">=</span> <span class="va">Weight_Height_lm</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">Height</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">fitted</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residual"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Height"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-heteroscedasticity%20example-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Since there is no obvious pattern in the residuals along the fitted
values or the explanatory variable, there is no reason to suspect that
the equal variance assumption has been violated.</p>
<div id="exercise-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-5" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-5"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Create diagnistic plots to check for heteroscedasticity in our
<code>BPSysAve_AgeMonths_lm</code> model.</li>
<li>Do you believe the equal variance assumption has been violated?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BPSysAve_AgeMonths_lm</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span><span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">BPSysAve</span> <span class="op">~</span> <span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="va">residualData</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span><span class="op">)</span>,</span>
<span>                    fitted <span class="op">=</span> <span class="fu">fitted</span><span class="op">(</span><span class="va">BPSysAve_AgeMonths_lm</span><span class="op">)</span>,</span>
<span>                    agemonths <span class="op">=</span> <span class="va">BPSysAve_AgeMonths_lm</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">AgeMonths</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">fitted</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">residualData</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">agemonths</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age in Months"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-heteroscedasticity%20challenge-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The variation in the residuals does somewhat increase with an
increase in fitted values and an increase in <code>AgeMonths</code>.
Therefore, this model may violate the homoscedasticity assumption.
Because the majority of residuals still lie in the central band, we may
not worry about this violation much. However, if we wanted to resolve
the increase in residuals, we may choose to add more variables to our
model or to apply a Box-Cox transformation on <code>BPSysAve</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="normality-of-errors">6. Normality of errors<a class="anchor" aria-label="anchor" href="#normality-of-errors"></a></h3>
<p>This assumption states that the errors follow a Normal distribution.
When this assumption is strongly violated, predictions of individual
data points from the model are less reliable. Small deviations from
normality may pose less of an issue. One way to check this assumption is
to plot a histogram of the residuals and to ask whether it looks
strongly non-normal (e.g.Â bimodal or uniform).</p>
<p>For example, looking at a histogram of the residuals of our
<code>Height_Weight_lm</code> model reveals a distribution that is
slightly skewed. Since this is not a strong deviation from normality, we
do not have to worry about violating the assumption.</p>
<p>Note that if a model includes a grouping variable (e.g.Â a two-level
categorical variable), the normality of the residuals is to be checked
separately for each group. Also note that in the previous episode, we
only covered prediction of the mean, not of individual data points. A
deviation of the residuals from normality is usually not a concern for
predictions of the mean.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">Weight_Height_lm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">residuals</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Residual"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-check%20normality%20example-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="exercise-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-6" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-6"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Construct a histogram of the residuals of the
<code>TotChol_SmokeNow_lm</code> model.</li>
<li>Does the distribution suggest that the normality assumption is
violated?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TotChol_SmokeNow_lm</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span>formula <span class="op">=</span> <span class="va">TotChol</span> <span class="op">~</span> <span class="va">SmokeNow</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>resid <span class="op">=</span> <span class="fu">resid</span><span class="op">(</span><span class="va">TotChol_SmokeNow_lm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">residuals</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Residual"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/05-fitAndAssumptionSLR-rendered-check%20normality%20challenge-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Since the distribution is only slightly skewed, we do not have to
worry about violating the normality assumption.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Assessing model fit is the process of visually checking whether the
model fits the data sufficiently well.</li>
<li>
<span class="math inline">\(R^2\)</span> quantifies the proportion
of variation in the response variable explained by the explanatory
variable. An <span class="math inline">\(R^2\)</span> close to 1
indicates that most variation is accounted for by the model, while an
<span class="math inline">\(R^2\)</span> close to 0 indicates that the
model does not perform much better than predicting the mean of the
response.</li>
<li>The six assumptions of the simple linear regression model are
validity, representativeness, linearity and additivity, independence of
errors, homoscedasticity of the residuals and normality of the
residuals.</li>
<li>We can check the assumptions of a simple linear regression model by
carefully considering our research question, the data set that we are
using and by visualising our model parameters.</li>
</ul></div>
</div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/04-predictionSLR.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-multiLvlFactor.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/04-predictionSLR.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous: Making predictions</a>
        <a class="chapter-link float-end" href="../instructor/06-multiLvlFactor.html" rel="next">Next: Optional: linear... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/edit/main/episodes/05-fitAndAssumptionSLR.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/" class="external-link">Source</a></p>
				<p><a href="https://github.com/fishtree-attempt/simple-linear-regression-public-health/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:elh605@york.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper" class="external-link">sandpaper (0.12.5)</a>,
        <a href="https://github.com/carpentries/pegboard" class="external-link">pegboard (0.5.3)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.17" class="external-link">varnish (0.2.17)</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://preview.carpentries.org/simple-linear-regression-public-health/instructor/05-fitAndAssumptionSLR.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Assessing simple linear regression model fit and assumptions",
  "creativeWorkStatus": "active",
  "url": "https://preview.carpentries.org/simple-linear-regression-public-health/instructor/05-fitAndAssumptionSLR.html",
  "identifier": "https://preview.carpentries.org/simple-linear-regression-public-health/instructor/05-fitAndAssumptionSLR.html",
  "dateCreated": "2022-11-15",
  "dateModified": "2023-07-11",
  "datePublished": "2023-08-01"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

